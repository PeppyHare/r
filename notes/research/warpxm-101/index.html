<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="What is WARPXM # WARPXM is a framework for solving hyperbolic PDE systems. By &ldquo;framework&rdquo; we mean that it is not a single tool for solving a particular type of system, but rather it contains a number of applications, solvers, and other tools which can be combined to model a wide variety of systems.
Installation # Source # To use WARPXM for running simulations, you must first gain access the WARPXM source code."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Getting Started with WARPXM"><meta property="og:description" content="What is WARPXM # WARPXM is a framework for solving hyperbolic PDE systems. By &ldquo;framework&rdquo; we mean that it is not a single tool for solving a particular type of system, but rather it contains a number of applications, solvers, and other tools which can be combined to model a wide variety of systems.
Installation # Source # To use WARPXM for running simulations, you must first gain access the WARPXM source code."><meta property="og:type" content="article"><meta property="og:url" content="https://peppyhare.github.io/r/notes/research/warpxm-101/"><meta property="article:section" content="notes"><meta property="article:modified_time" content="2023-06-08T16:16:00-07:00"><title>Getting Started with WARPXM | My Notes</title><link rel=manifest href=/r/manifest.json><link rel=icon href=/r/favicon.png type=image/x-icon><link rel=stylesheet href=/r/book.min.3c7f42c913e8864f817f813e5a43db72a7e65e5f1117470753a8da987023ae25.css integrity="sha256-PH9CyRPohk+Bf4E+WkPbcqfmXl8RF0cHU6jamHAjriU=" crossorigin=anonymous><script defer src=/r/flexsearch.min.js></script>
<script defer src=/r/en.search.min.725cf6a7d11cbc773cff8cc7291972d64516697ac9d8aefbe5b5998f1c0ce062.js integrity="sha256-clz2p9EcvHc8/4zHKRly1kUWaXrJ2K775bWZjxwM4GI=" crossorigin=anonymous></script>
<script defer src=/r/sw.min.9e3a83f0b071ebe0141a16a33db93faadb2bdf712473a218febeed35ed243c08.js integrity="sha256-njqD8LBx6+AUGhajPbk/qtsr33Ekc6IY/r7tNe0kPAg=" crossorigin=anonymous></script>
<link rel=preload href=/r/katex/fonts/KaTeX_Main-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Main-Bold.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Main-Italic.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Math-Italic.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Size2-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Size3-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/fonts/roboto-v27-latin-regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/fonts/roboto-v27-latin-700.woff2 as=font type=font/woff2 crossorigin=anonymous></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/r/><span>My Notes</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/r/svg/translate.svg class=book-icon alt=Languages>
English</a></label><ul></ul></li></ul><ul><li class=book-section-flat><ul><li class=book-section-flat><input type=checkbox id=section-3c2351b6c36eb8737d2b3aab84ebe41a class=toggle>
<label for=section-3c2351b6c36eb8737d2b3aab84ebe41a class="flex justify-between"><a href=/r/notes/UWAA545/ class="navbutton
book-collapse-section">Computational Methods For Plasmas</a></label><ul><li><a href=/r/notes/UWAA545/01-syllabus/ class=navbutton>Syllabus</a></li><li><a href=/r/notes/UWAA545/02-plasma-models/ class=navbutton>Plasma Models</a></li><li><a href=/r/notes/UWAA545/03-pic-method/ class=navbutton>Particle in Cell Model</a></li><li><a href=/r/notes/UWAA545/04-pic-example/ class=navbutton>PIC - Example Implementation</a></li><li><a href=/r/notes/UWAA545/05-electrodynamic-pic/ class=navbutton>Multidimensional Electrodynamic PIC</a></li><li><a href=/r/notes/UWAA545/06-fluid-models/ class=navbutton>Fluid Models for Plasmas</a></li><li><a href=/r/notes/UWAA545/07-finite-difference-models/ class=navbutton>Finite Difference Methods for MHD</a></li><li><a href=/r/notes/UWAA545/08-mhd-equilibrium/ class=navbutton>MHD Equilibrium Calculations</a></li><li><a href=/r/notes/UWAA545/formulary/ class=navbutton>Formulary</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-6349dd4237c5b36ce5c3738b93bc5885 class=toggle>
<label for=section-6349dd4237c5b36ce5c3738b93bc5885 class="flex justify-between"><a href=/r/notes/UWAA560/ class="navbutton
book-collapse-section">Plasma Diagnostics</a></label><ul><li><a href=/r/notes/UWAA560/01-syllabus/ class=navbutton>Syllabus</a></li><li><a href=/r/notes/UWAA560/02-diagnostic-considerations/ class=navbutton>General Diagnostic Considerations</a></li><li><a href=/r/notes/UWAA560/03-magnetic-field-diagnostics/ class=navbutton>Magnetic Field Diagnostics</a></li><li><a href=/r/notes/UWAA560/04-electrostatic-diagnostics/ class=navbutton>Electrostatic Diagnostics</a></li><li><a href=/r/notes/UWAA560/05-index-of-refraction-measurements/ class=navbutton>Index of Refraction Measurements</a></li><li><a href=/r/notes/UWAA560/06-spectroscopic-measurements/ class=navbutton>Spectroscopic Measurements</a></li><li><a href=/r/notes/UWAA560/90-student-lectures/ class=navbutton>Student Lectures</a></li><li><a href=/r/notes/UWAA560/91-zeeman-spectroscopy/ class=navbutton>My class lecture</a></li><li><a href=/r/notes/UWAA560/formulary/ class=navbutton>Formulary</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-edf338bf880234e7aba93d04934ebde0 class=toggle>
<label for=section-edf338bf880234e7aba93d04934ebde0 class="flex justify-between"><a href=/r/notes/UWAA558/ class="navbutton
book-collapse-section">MHD Theory</a></label><ul><li><a href=/r/notes/UWAA558/01-syllabus/ class=navbutton>Syllabus</a></li><li><a href=/r/notes/UWAA558/02-plasma-models/ class=navbutton>Plasma Models</a></li><li><a href=/r/notes/UWAA558/03-plasma-fluid-model/ class=navbutton>Plasma Fluid Model</a></li><li><a href=/r/notes/UWAA558/04-two-fluid-plasma-model/ class=navbutton>Two-Fluid Plasma Model</a></li><li><a href=/r/notes/UWAA558/05-mhd-model/ class=navbutton>Magnetohydrodynamic (MHD) Model</a></li><li><a href=/r/notes/UWAA558/06-boundary-conditions/ class=navbutton>Boundary Conditions</a></li><li><a href=/r/notes/UWAA558/07-equilibrium-for-fusion/ class=navbutton>Equilibrium for Fusion</a></li><li><a href=/r/notes/UWAA558/08-1d-equilibria/ class=navbutton>1-D Equilibria</a></li><li><a href=/r/notes/UWAA558/09-2d-equilibria/ class=navbutton>2D Equilibria</a></li><li><a href=/r/notes/UWAA558/10-equilibrium-of-3d-configurations/ class=navbutton>Equilibrium of 3D Configurations</a></li><li><a href=/r/notes/UWAA558/11-mhd-stability/ class=navbutton>MHD Stability</a></li><li><a href=/r/notes/UWAA558/formulary/ class=navbutton>Formulary</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-0ab4cc33a17dbfeaac89afca6a70923e class=toggle checked>
<label for=section-0ab4cc33a17dbfeaac89afca6a70923e class="flex justify-between"><a href=/r/notes/research/ class="navbutton
book-collapse-section">Research Notes</a></label><ul><li><a href=/r/notes/research/dgh-datta/ class=navbutton>Electrodynamic Dory-Guest-Harris Instability</a></li><li><a href=/r/notes/research/warpxm-101/ class="active navbutton">Getting Started with WARPXM</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-413f74fd9b5926250a41b61f37ddacc6 class=toggle>
<label for=section-413f74fd9b5926250a41b61f37ddacc6 class="flex justify-between"><a href=/r/notes/UWAA557/ class="navbutton
book-collapse-section">Physics of Fusion Plasmas</a></label><ul><li><a href=/r/notes/UWAA557/ch10-0/ class=navbutton>Rules of thumb</a></li><li><a href=/r/notes/UWAA557/ch10-1/ class=navbutton>Statistical Mechanics</a></li><li><a href=/r/notes/UWAA557/ch10-2/ class=navbutton>Review of E&amp;M</a></li><li><a href=/r/notes/UWAA557/ch10-3/ class=navbutton>Lagrange Multipliers</a></li><li><a href=/r/notes/UWAA557/ch11-1/ class=navbutton>Wall-supported Plasma</a></li><li><a href=/r/notes/UWAA557/ch11-2/ class=navbutton>Collisions</a></li><li><a href=/r/notes/UWAA557/ch11-3/ class=navbutton>Oscillations</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-f5aa9ed14dd55f47a51954bafbe42c68 class=toggle>
<label for=section-f5aa9ed14dd55f47a51954bafbe42c68 class="flex justify-between"><a href=/r/notes/UWAA543/ class="navbutton
book-collapse-section">Computational CFD</a></label><ul><li><a href=/r/notes/UWAA543/ch20-1/ class=navbutton>Introduction to Computational CFD</a></li><li><a href=/r/notes/UWAA543/ch20-2/ class=navbutton>Governing Equations</a></li><li><a href=/r/notes/UWAA543/ch20-3/ class=navbutton>Reduced Models</a></li><li><a href=/r/notes/UWAA543/ch20-4/ class=navbutton>Equation Types</a></li><li><a href=/r/notes/UWAA543/ch20-5/ class=navbutton>Panel Method</a></li><li><a href=/r/notes/UWAA543/ch21-1/ class=navbutton>Finite Difference Algorithms</a></li><li><a href=/r/notes/UWAA543/ch21-2/ class=navbutton>Explicit Finite Difference Algorithms</a></li><li><a href=/r/notes/UWAA543/ch21-3/ class=navbutton>Finite Difference and Finite Volume Methods</a></li><li><a href=/r/notes/UWAA543/ch21-4/ class=navbutton>Implicit Algorithms</a></li><li><a href=/r/notes/UWAA543/ch21-5/ class=navbutton>Numerical Boundary Conditions</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-fec96caaff8d6393621cb5c836aaffe6 class=toggle>
<label for=section-fec96caaff8d6393621cb5c836aaffe6 class="flex justify-between"><a href=/r/notes/UWAA556/ class="navbutton
book-collapse-section">Plasma Waves</a></label><ul><li><a href=/r/notes/UWAA556/ch01-1/ class=navbutton>Mathematical review</a></li><li><a href=/r/notes/UWAA556/ch02-1/ class=navbutton>Plasma Waves in General Dielectric Media</a></li><li><a href=/r/notes/UWAA556/ch02-2/ class=navbutton>Wave Properties in Cold Unmagnetized Plasma</a></li><li><a href=/r/notes/UWAA556/ch02-3/ class=navbutton>Cold Magnetized Plasma Dispersion Relation</a></li><li><a href=/r/notes/UWAA556/ch02-4/ class=navbutton>The CMA Diagram</a></li><li><a href=/r/notes/UWAA556/ch03-1/ class=navbutton>Introduction to Kinetic Theory</a></li><li><a href=/r/notes/UWAA556/ch03-2/ class=navbutton>Landau Damping</a></li><li><a href=/r/notes/UWAA556/ch03-3/ class=navbutton>Waves in Hot Magnetized Plasma</a></li><li><a href=/r/notes/UWAA556/ch04-1/ class=navbutton>Fluid stuff</a></li><li><a href=/r/notes/UWAA556/ch04-2/ class=navbutton>Quasi-Linear Theory</a></li><li><a href=/r/notes/UWAA556/ch05-1/ class=navbutton>Diffusion and Resistivity</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-8fb1297aabc80ae7754972056ff59a2d class=toggle>
<label for=section-8fb1297aabc80ae7754972056ff59a2d class="flex justify-between"><a href=/r/notes/problems/ class="navbutton
book-collapse-section">Worked Problems</a></label><ul><li><a href=/r/notes/problems/gurnett/ch02/ class=navbutton>Characteristic Parameters of a Plasma</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-3cae707fb8713119044de8d3ecbe7266 class=toggle>
<label for=section-3cae707fb8713119044de8d3ecbe7266 class="flex justify-between"><a role=button class="navbutton
book-collapse-section">Scratch</a></label><ul><li><a href=/r/notes/scratch/colors/ class=navbutton>Adding Color</a></li><li><a href=/r/notes/scratch/crews2018/ class=navbutton>Crews (2018)</a></li><li><a href=/r/notes/scratch/datta2021/ class=navbutton>Datta (2021)</a></li><li><a href=/r/notes/scratch/drawing/ class=navbutton>Drawing Diagrams</a></li><li><a href=/r/notes/scratch/goedbloed/ class=navbutton>Goedbloed (2019)</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-ee5e070eb25b63f2c377d750d37f67ae class=toggle>
<label for=section-ee5e070eb25b63f2c377d750d37f67ae class="flex justify-between"><a href=/r/notes/griffiths/ class="navbutton
book-collapse-section">Griffiths Introduction to Electrodynamics</a></label><ul><li><a href=/r/notes/griffiths/ch1-1/ class=navbutton>Vector Algebra</a></li><li><a href=/r/notes/griffiths/ch1-2/ class=navbutton>Differential Calculus</a></li><li><a href=/r/notes/griffiths/ch1-3/ class=navbutton>Integral Calculus</a></li><li><a href=/r/notes/griffiths/ch1-4/ class=navbutton>Curvilinear Coordinates</a></li><li><a href=/r/notes/griffiths/ch1-5/ class=navbutton>The Dirac Delta Function</a></li><li><a href=/r/notes/griffiths/ch1-6/ class=navbutton>The Theory of Vector Fields</a></li><li><a href=/r/notes/griffiths/ch2-1/ class=navbutton>The Electric Field</a></li><li><a href=/r/notes/griffiths/ch2-2/ class=navbutton>Divergence and Curl of Electrostatic Fields</a></li><li><a href=/r/notes/griffiths/ch2-3/ class=navbutton>Electric Potential</a></li><li><a href=/r/notes/griffiths/ch2-4/ class=navbutton>Work and Energy in Electrostatics</a></li><li><a href=/r/notes/griffiths/ch2-5/ class=navbutton>Conductors</a></li><li><a href=/r/notes/griffiths/ch3-1/ class=navbutton>Laplace's Equation</a></li><li><a href=/r/notes/griffiths/ch3-2/ class=navbutton>The Method of Images</a></li><li><a href=/r/notes/griffiths/ch3-3/ class=navbutton>Separation of Variables</a></li><li><a href=/r/notes/griffiths/ch3-4/ class=navbutton>Multipole Expansion</a></li><li><a href=/r/notes/griffiths/ch4-1/ class=navbutton>Polarization</a></li><li><a href=/r/notes/griffiths/ch4-2/ class=navbutton>The Field of a Polarized Object</a></li><li><a href=/r/notes/griffiths/ch4-3/ class=navbutton>The Electric Displacement</a></li><li><a href=/r/notes/griffiths/ch4-4/ class=navbutton>The Linear Dielectrics</a></li><li><a href=/r/notes/griffiths/ch5-1/ class=navbutton>The Lorentz Force Law</a></li><li><a href=/r/notes/griffiths/ch5-2/ class=navbutton>The Biot-Savart Law</a></li><li><a href=/r/notes/griffiths/ch5-3/ class=navbutton>The Divergence and Curl of B</a></li><li><a href=/r/notes/griffiths/ch5-4/ class=navbutton>Magnetic Vector Potential</a></li><li><a href=/r/notes/griffiths/ch6-1/ class=navbutton>Magnetization</a></li><li><a href=/r/notes/griffiths/ch6-2/ class=navbutton>The Field of a Magnetized Object</a></li><li><a href=/r/notes/griffiths/ch6-3/ class=navbutton>The Auxiliary Field H</a></li><li><a href=/r/notes/griffiths/ch6-4/ class=navbutton>Linear and Nonlinear Media</a></li><li><a href=/r/notes/griffiths/ch7-1/ class=navbutton>Electromotive Force</a></li><li><a href=/r/notes/griffiths/ch7-2/ class=navbutton>Electromagnetic Induction</a></li><li><a href=/r/notes/griffiths/ch7-3/ class=navbutton>Maxwell's Equations</a></li><li><a href=/r/notes/griffiths/ch8-0/ class=navbutton>Phys 544 Introduction</a></li><li><a href=/r/notes/griffiths/ch8-1/ class=navbutton>Charge and Energy</a></li><li><a href=/r/notes/griffiths/ch8-2/ class=navbutton>Momentum</a></li><li><a href=/r/notes/griffiths/ch9-1/ class=navbutton>Electromagnetic Waves in One Dimension</a></li><li><a href=/r/notes/griffiths/ch9-2/ class=navbutton>Wave Equation for E and B</a></li><li><a href=/r/notes/griffiths/ch9-3/ class=navbutton>Electromagnetic Waves in Matter</a></li><li><a href=/r/notes/griffiths/ch9-4/ class=navbutton>Electromagnetic Waves in Conductors</a></li><li><a href=/r/notes/griffiths/ch9-5/ class=navbutton>Guided Waves</a></li><li><a href=/r/notes/griffiths/ch10-1/ class=navbutton>Scalar and Vector Potentials</a></li><li><a href=/r/notes/griffiths/ch10-2/ class=navbutton>Retarded Potentials</a></li><li><a href=/r/notes/griffiths/ch10-3/ class=navbutton>Point Charges</a></li><li><a href=/r/notes/griffiths/ch11-1/ class=navbutton>Dipole Radiation</a></li><li><a href=/r/notes/griffiths/problems-ch3/ class=navbutton>Solved Problems Ch3</a></li><li><a href=/r/notes/griffiths/problems-ch5/ class=navbutton>Solved Problems Ch5</a></li><li><a href=/r/notes/griffiths/problems-ch7/ class=navbutton>Solved Problems Ch7</a></li><li><a href=/r/notes/griffiths/problems-ch9/ class=navbutton>Solved Problems Ch9</a></li></ul></li></ul></li></ul><ul class=book-menu-hugo><li><a href=https://github.com/Peppyhare/r target=_blank rel=noopener>Github</a></li><li><a href=https://themes.gohugo.io/hugo-book/ target=_blank rel=noopener>Hugo Themes</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/r/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Getting Started with WARPXM</strong>
<label for=toc-control><img src=/r/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#what-is-warpxm>What is WARPXM</a></li><li><a href=#installation>Installation</a><ul><li><a href=#source>Source</a></li><li><a href=#prerequisites-warpxm>Prerequisites: WARPXM</a></li><li><a href=#prerequisites-warpy>Prerequisites: Warpy</a></li><li><a href=#build---vscode>Build - VSCode</a></li><li><a href=#build---command-line>Build - Command-line</a></li></ul></li><li><a href=#basic-example>Basic Example</a></li><li><a href=#debugging>Debugging</a><ul><li><a href=#excessive-stdout>Excessive stdout</a></li><li><a href=#attaching-debugger-c-in-vs-code-with-gdb-or-lldb>Attaching Debugger: C++ in VS Code with <code>gdb</code> or <code>lldb</code></a></li><li><a href=#attaching-debugger-c-with-gdb>Attaching Debugger: C++ with <code>gdb</code></a></li><li><a href=#attaching-debugger-python-in-vs-code-with-debugpy>Attaching Debugger: Python in VS Code with <code>debugpy</code></a></li><li><a href=#attaching-debugger-pdb>Attaching Debugger: <code>pdb</code></a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=what-is-warpxm>What is WARPXM
<a class=anchor href=#what-is-warpxm>#</a></h1><p>WARPXM is a <em>framework</em> for solving hyperbolic PDE systems. By &ldquo;framework&rdquo; we mean that it is not a single tool for solving a particular type of system, but rather it contains a number of applications, solvers, and other tools which can be combined to model a wide variety of systems.</p><h1 id=installation>Installation
<a class=anchor href=#installation>#</a></h1><h2 id=source>Source
<a class=anchor href=#source>#</a></h2><p>To use WARPXM for running simulations, you must first gain access the WARPXM source code. The code is currently hosted on GitLab:
<a href=https://gitlab.com/warpxm/warpxm>https://gitlab.com/warpxm/warpxm</a>. Obtaining access generally involves being added as a collaborator to the repository by one of the existing owners.</p><p>Once you have access, clone the repository to wherever you would like to work on your local machine:</p><pre tabindex=0><code>cd /path/to/your/workspace
git clone git@gitlab.com:warpxm/warpxm.git
</code></pre><h2 id=prerequisites-warpxm>Prerequisites: WARPXM
<a class=anchor href=#prerequisites-warpxm>#</a></h2><p>Building the <code>warpxm</code> executable itself is the most important part. It is a C++ project which uses CMake as the build system. The main dependencies required to build <code>warpxm</code> are:</p><ul><li>PETSc: A sort of toolkit / package manager for scientific computing packages. It is the underlying framework which <code>warpxm</code> is built on top of. It can also be used to install compatible versions of most of the other dependencies, like OpenMPI, METIS, HDF5, BLAS/LAPACK, and CMake.</li><li>OpenMPI: Message-passing interface used to parallelize simulations across independent compute cores.</li><li>HDF5: Library used to read & write HDF5-formatted simulation data to disk.</li><li>METIS: Graph and mesh partitioning library.</li></ul><blockquote class="book-hint info"><p><strong>Mac OS</strong></p><p>In my experience, the simplest way to install the required dependencies (especially on the newer M1/M2 Apple architecture) is to simply use the pre-packaged
<a href=https://brew.sh/>Homebrew</a> formulas to install the required dependencies at the system level:</p><pre tabindex=0><code>brew install petsc hdf5-mpi cmake gcc metis openblas scalapack pkg-config
</code></pre><p>That&rsquo;s it, all of the C++/CMake dependencies are now installed at the system level! No need to modify any <code>PATH</code>/<code>LD_LIBRARY_PATH</code>/<code>PKG_CONFIG_PATH</code> environment variables.</p><details><summary>Debugging steps</summary><div class=markdown-inner><ul><li>If installing C++ compilers for the first time on a new Mac, need to run <code>xcode-select --install</code> to accept the Xcode license and enable installing compilers provided by Apple. One of the above homebrew formulae will probably prompt you do to so when it is installed.</li><li><code>brew install petsc</code> may implicitly install the <code>hdf5</code> formlua, which is not compatible with WARPXM. If you get an error message along the lines of &ldquo;HDF5 was not compiled with MPI&rdquo;, try removing the non-mpi version and re-installing the mpi version of hdf5:<pre tabindex=0><code>brew uninstall --ignore-dependencies hdf5 hdf5-mpi
brew install hdf5-mpi
</code></pre></li><li>If you have already tried to build WARPXM and needed to re-install some <code>brew</code> formula, you should get rid of any CMake caches that were created when you last tried to build. The easiest way to do this is to delete the whole build folder, then run <code>cmake /path/to/warpxm</code> again. This will force CMake to attempt to locate the dependencies in their new location, rather than trying to re-use an installation that you have already removed.</li></ul></div></details></blockquote><blockquote class="book-hint info"><p><strong>Ubuntu Linux</strong></p><p>There are two general types of installation you can try:</p><ul><li>Install PETSc and some external packages in a user-specific location. This prevents conflicts with any other installations of e.g. metis or openmpi that you already have installed, but requires you to update your <code>PATH</code>/<code>LD_LIBRARY_PATH</code>/<code>PKG_CONFIG_PATH</code> environment variables accordingly to make use of the local installation.</li><li>Install all of the WARPXM dependencies as system-level packages (including PETSc). This means that the versions installed for WARPXM will be used everywhere on the system. You do not have to update your <code>PATH</code>/<code>LD_LIBRARY_PATH</code>/<code>PKG_CONFIG_PATH</code> environment variables.</li></ul><h3 id=system-wide-installation>System-wide Installation
<a class=anchor href=#system-wide-installation>#</a></h3><details><summary>Install steps</summary><div class=markdown-inner><p>If you run into issues with user-specific PETSc configuration, or are running into conflicts between system-level METIS/libblas/open-mpi packages and the PETSc dependencies, then it may help to use PETSc itself to install all of the dependencies at the system level. This avoids the need to set any <code>PATH</code>/<code>LD_LIBRARY_PATH</code>/<code>PKG_CONFIG_PATH</code> environment variables, as all of the required libraries will be installed in the default locations.</p><blockquote><p>Note: This can take a long time to finish! You are essentially building openmpi, hdf5, hypre, superlu, metis, parmetis, fblaslapack, and cmake all from source with compiler optimizations enabled, so there is some real work to be done, but the end result should be a stable, performant installation.</p></blockquote><ol><li>Install compilers, openmpi, and other basic tools from apt repositories:</li></ol><pre tabindex=0><code>sudo apt-get update
sudo apt-get install -y --no-install-recommends \
  build-essential \
  ca-certificates \
  cmake \
  curl \
  g++ \
  gfortran \
  git \
  libopenmpi-dev \
  openmpi-bin \
  pkg-config \
  python3-pip \
  sudo \
  wget
</code></pre><ol start=2><li>Install PETSc and dependencies from source. The <code>--prefix=/usr/local</code> flag means that all headers and libraries will be installed to <code>/usr/local</code>, which is in the default search path for all users on nearly all Debian-based linux distributions.</li></ol><pre tabindex=0><code>export PETSC_DIR=&#34;$HOME&#34;/tools/petsc
mkdir -p &#34;$HOME&#34;/tools
git clone https://gitlab.com/petsc/petsc.git --depth=1 --branch=release &#34;$PETSC_DIR&#34;
cd &#34;$PETSC_DIR&#34;
git checkout release
sudo ./configure \
  --COPTFLAGS=&#34;-O3&#34; \
  --CXXOPTFLAGS=&#34;-O3&#34; \
  --FOPTFLAGS=&#34;-O3&#34; \
  --download-hypre \
  --download-superlu_dist \
  --download-metis \
  --download-parmetis \
  --download-hdf5 \
  --download-fblaslapack \
  --download-cmake \
  --with-debugging=0 \
  --prefix=/usr/local
sudo chown -R &#34;$USER&#34;:&#34;$USER&#34; &#34;$PETSC_DIR&#34;
make PETSC_DIR=&#34;$PETSC_DIR&#34; PETSC_ARCH=arch-linux-c-opt all check
sudo make PETSC_DIR=&#34;$PETSC_DIR&#34; PETSC_ARCH=arch-linux-c-opt install
</code></pre></div></details><h3 id=user-installation>User Installation
<a class=anchor href=#user-installation>#</a></h3><details><summary>Install steps</summary><div class=markdown-inner>You can follow the
<a href=http://faculty.washington.edu/shumlak/WARPX/html/install.html>Pre-install setup for Ubuntu Linux desktop instructions for on the wiki</a> to install <code>openmpi</code>, <code>cmake</code>, and <code>libblas</code> from the apt package repositories, then get PETSc to download and install the rest to your own home directory, using the <code>--prefix=$HOME/usr</code> flag when configuring PETSc.</div></details></blockquote><h2 id=prerequisites-warpy>Prerequisites: Warpy
<a class=anchor href=#prerequisites-warpy>#</a></h2><p>The <code>warpy</code> Python module under <code>tools/warpy</code> contains helpful classes and functions that can be used to build and run input files for <code>warpxm</code>. You need to install a few additional Python modules to make full use of the plotting and diagnostic modules in <code>warpy</code>:</p><pre tabindex=0><code>pip install numpy matplotlib h5py
</code></pre><p>We also need to make sure that Python knows where to find the <code>warpy</code> module by adding it to our <code>PYTHONPATH</code> environment variable:</p><ul><li><p>If you are using <code>bash</code> for your shell, open <code>$HOME/.bash_profile</code> and add the following at the end:</p><pre tabindex=0><code>export PYTHONPATH=&#34;/path/to/your/workspace/warpxm/build/tools/&#34;:$PYTHONPATH
</code></pre></li><li><p>If you are using <code>zsh</code> for your shell, open <code>$HOME/.zshrc</code> and add the following at the end:</p><pre tabindex=0><code>export PYTHONPATH=&#34;/path/to/your/workspace/warpxm/build/tools/&#34;:$PYTHONPATH
</code></pre></li><li><p>If you are using <code>fish</code> for your shell, open <code>$HOME/.config/fish.config</code> and add the following at the end:</p><pre tabindex=0><code>set -gx PYTHONPATH &#34;/path/to/your/workspace/warpxm/build/tools/&#34;:$PYTHONPATH
</code></pre></li></ul><h2 id=build---vscode>Build - VSCode
<a class=anchor href=#build---vscode>#</a></h2><p>I like to use
<a href=https://code.visualstudio.com/>VS Code</a> as my development environment, since it is cross-platform, has a very large feature set, and adequate performance. The C++ and CMake extensions can help make building and debugging <code>warpxm</code> much easier.</p><ul><li>Install the
<a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools">ms-vscode.cpptools extension</a></li><li>Install the
<a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.cmake-tools">ms-vscode.cmake-tools extension</a></li><li>Create a new workspace at the root of the <code>warpxm</code> repository. The CMake extension will create a <code>warpxm/build</code> directory for &ldquo;in-source&rdquo; builds, which should work fine as long as you don&rsquo;t need to test many different build configurations simultaneously.</li><li>Using the command pallette, run the &ldquo;Cmake: Select Variant` command to select either &ldquo;Release&rdquo; (for optimized execution) or &ldquo;Debug&rdquo; (for additional assertions and debug symbols)</li><li>Run the &ldquo;Cmake: Configure&rdquo; command to tell CMake to locate all of the required dependencies and generate linux Makefiles in the build directory.</li><li>Run the &ldquo;Cmake: Build&rdquo; command to compile the whole project into the build directory. This can take several minutes the first time around, but compiled objects will be cached in between builds so small changes will re-compile quickly.</li></ul><p>Congratulations, you&rsquo;ve built it! To check that the compiled executable actually works, navigate to the <code>warpxm/build</code> directory and run <code>make test</code>.</p><h2 id=build---command-line>Build - Command-line
<a class=anchor href=#build---command-line>#</a></h2><p>The
<a href=http://faculty.washington.edu/shumlak/WARPX/html/install.html>install instructions on the wiki</a> are great for building at the command-line. Broadly speaking, you will run <code>cmake</code> to locate dependencies and generate linux Makefiles for the project in a build directory, then run <code>make</code> to actually compile the project in the build directory.</p><h1 id=basic-example>Basic Example
<a class=anchor href=#basic-example>#</a></h1><p>What do we need to define a valid discontinuous Galerkin simulation? Check the <code>dg_sim</code> warpy class definition!</p><table><thead><tr><th>Parameter</th><th>Optional?</th><th>Description</th></tr></thead><tbody><tr><td><code>name</code></td><td>⛔</td><td>Descriptor for the particular simulation, used as a filename prefix for storing data.</td></tr><tr><td><code>meshes</code></td><td>⛔</td><td>List of one or more mesh objects which define the spatial extent of the simulation.</td></tr><tr><td><code>initial_conditions</code></td><td>⛔</td><td>List of one or more variable adjusters which are applied before the first time step.</td></tr><tr><td><code>temporal_solvers</code></td><td>⛔</td><td>List of one or more time integrator host actions which move the state forward in time.</td></tr><tr><td><code>dt_controller</code></td><td>⛔</td><td>Determines the length of each time step. Can be a simple constant <code>dt</code>, or can make use of adaptive time steppers to progress more quickly when possible.</td></tr><tr><td><code>time</code></td><td>⛔</td><td>The start and end of the time interval to integrate.</td></tr><tr><td><code>writers</code></td><td>✅</td><td>One or more &ldquo;writer&rdquo; host actions which are called upon to export snapshot data to disk. These can be simple writers that just export the current value of some variables, or they can be diagnostic writers which e.g. integrate variables across the domain before writing. Very useful for evaluating numerical stability and evaluating instability growth rates.</td></tr><tr><td><code>write_steps</code></td><td>✅</td><td>Number of times during the simulation the provided <code>writers</code> should write data out to disk.</td></tr><tr><td><code>cfl_max</code></td><td>✅</td><td>Maximum allowable Courant–Friedrichs–Lewy number. Defaults to 1</td></tr><tr><td><code>flexible_writeout</code></td><td>✅</td><td></td></tr><tr><td><code>verbosity</code></td><td>✅</td><td>Defaults to &ldquo;info&rdquo;</td></tr><tr><td><code>global_verbosity</code></td><td>✅</td><td>Defaults to &ldquo;info&rdquo;</td></tr><tr><td><code>num_partitions</code></td><td>✅</td><td>Defaults to 1</td></tr><tr><td><code>enable_fpe</code></td><td>✅</td><td>Defaults to True</td></tr><tr><td><code>extra_start_host_actions</code></td><td>✅</td><td></td></tr><tr><td><code>pre_ti_host_actions</code></td><td>✅</td><td></td></tr><tr><td><code>post_ti_host_actions</code></td><td>✅</td><td></td></tr><tr><td><code>extra_end_host_actions</code></td><td>✅</td><td></td></tr></tbody></table><p>The most basic example provided in the repo solves the 1-dimensional linear advection system:</p><link rel=stylesheet href=/r/katex/katex.min.css><script defer src=/r/katex/katex.min.js></script>
<script defer src=/r/katex/auto-render.min.js onload=loadKatex()></script><span>
\[\pdv{q}{t} + \div (\vec c q) = 0\]</span>
<script>function loadKatex(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}],throwOnError:!1,trust:e=>["\\htmlId","\\href"].includes(e.command),macros:{"\\lcm":"\\mathop{\\mathrm{lcm}}","\\sen":"\\text{sen}\\,","\\dd":"\\mathop{\\mathrm{d} #1}","\\abs":`\\lvert #1 \\rvert`,"\\dd":"\\text{d}","\\cross":"\\times","\\pdv":"\\frac{\\partial #1}{\\partial #2}","\\curl":`\\nabla \\cross #1`,"\\vu":"\\mathbf{\\hat{#1}}","\\vdot":"\\dot","\\div":`\\nabla \\cdot #1`,"\\grad":`\\nabla`,"\\dv":"\\frac{d\\,#1}{d\\,#2}","\\gr":"\\gamma","\\vec":"\\mathbf{#1}","\\tagl":"\\tag{#1}","\\eqref":"(#1)","\\laplacian":`\\mathbf{\\nabla ^2}`,"\\label":"{}","\\negadelta":`\\nabla`,"\\eqref":"\\href{###1}{(\\text{#1})}","\\ref":"\\href{###1}{\\text{#1}}","\\label":"\\htmlId{#1}{}"}})}</script><p>This system has been implemented as a WARPXM application within <code>src/apps/simple/advection.cc</code> and registered with the type ID &ldquo;advection&rdquo;:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&#34;lib/wxcreator.h&#34;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>REGISTER_CREATOR(<span style=color:#e6db74>&#34;advection&#34;</span>, wxm<span style=color:#f92672>::</span>apps<span style=color:#f92672>::</span>advection_t, WmApplication);
</span></span></code></pre></div><p>The <code>advection</code> warpy application class in <code>tools/warpy/apps/simple.py</code> lets us set up a warpy simulation to model the advection system. First, we need to define the fluid variable <code>q</code>, which in our case will be the density \( \rho \). We&rsquo;ll use basis elements with third-order spatial convergence for the spatial mesh:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> warpy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Use second-order polynomial basis elements</span>
</span></span><span style=display:flex><span>sorder <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;thirdOrder&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create a variable for the fluid</span>
</span></span><span style=display:flex><span>fluid <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>variable(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;fluid&#39;</span>, components<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;rho&#39;</span>], basis_array_set<span style=color:#f92672>=</span>sorder)
</span></span><span style=display:flex><span><span style=color:#75715e># Set up the advection application operating on the fluid variable</span>
</span></span><span style=display:flex><span>apps <span style=color:#f92672>=</span> [warpy<span style=color:#f92672>.</span>apps<span style=color:#f92672>.</span>advection(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;advection&#39;</span>, variable<span style=color:#f92672>=</span>fluid, velocity<span style=color:#f92672>=</span>velocity)]
</span></span></code></pre></div><p>We then need boundary conditions and an initial condition. Let&rsquo;s set a step-function initial condition. The initial condition is a variable adjuster host action which is applied just before the first time step:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>fluid_ic <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>apps<span style=color:#f92672>.</span>functions<span style=color:#f92672>.</span>arbitrary<span style=color:#f92672>.</span>heaviside(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;fluid_ic&#39;</span>,
</span></span><span style=display:flex><span>                                                    variable<span style=color:#f92672>=</span>fluid,
</span></span><span style=display:flex><span>                                                    left<span style=color:#f92672>=</span><span style=color:#ae81ff>0.1</span>,
</span></span><span style=display:flex><span>                                                    right<span style=color:#f92672>=</span><span style=color:#ae81ff>0.6</span>)
</span></span><span style=display:flex><span>ic_va <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>variable_adjusters<span style=color:#f92672>.</span>function_evaluation<span style=color:#f92672>.</span>function_evaluator(
</span></span><span style=display:flex><span>    name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ic_va&#39;</span>,
</span></span><span style=display:flex><span>    priority<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    spatial_order<span style=color:#f92672>=</span>sorder,
</span></span><span style=display:flex><span>    on_subdomains<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;all&#39;</span>],
</span></span><span style=display:flex><span>    applications<span style=color:#f92672>=</span>[fluid_ic])
</span></span><span style=display:flex><span>ic_ha <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>host_actions<span style=color:#f92672>.</span>va_runner(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ic_ha&#39;</span>, variable_adjusters<span style=color:#f92672>=</span>[ic_va])
</span></span></code></pre></div><p>To set up our temporal solver, we first specify that we want to use the discontinuous Galerkin spatial solver operating on our advection application:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>spatial_solver <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>spatial_solvers<span style=color:#f92672>.</span>dg(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dg&#34;</span>,
</span></span><span style=display:flex><span>                                          spatial_order<span style=color:#f92672>=</span>sorder,
</span></span><span style=display:flex><span>                                          applications<span style=color:#f92672>=</span>apps,
</span></span><span style=display:flex><span>                                          on_subdomains<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;all&#39;</span>])
</span></span></code></pre></div><p>The temporal solver will be the third-order explicit Runge Kutta time stepper, and we will use a fixed time step:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>temporal_solver <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>host_actions<span style=color:#f92672>.</span>erk(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;rk&#39;</span>,
</span></span><span style=display:flex><span>                                         scheme<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;SSPRK3&#39;</span>,
</span></span><span style=display:flex><span>                                         spatial_solvers<span style=color:#f92672>=</span>[spatial_solver],
</span></span><span style=display:flex><span>                                         variable_adjusters<span style=color:#f92672>=</span>[])
</span></span><span style=display:flex><span>dt <span style=color:#f92672>=</span> <span style=color:#ae81ff>1e-4</span>
</span></span><span style=display:flex><span>dt_final <span style=color:#f92672>=</span> <span style=color:#ae81ff>2.0</span>
</span></span><span style=display:flex><span>dt_controller <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>dt_calc<span style=color:#f92672>.</span>fixed_dt(dt)
</span></span></code></pre></div><p>Periodic boundary conditions are the default, so we do not need to explicitly specify any boundary conditions. If we wanted different boundary conditions, such as Dirichlet conditions on \( \rho \), we could specify them as additional variable adjusters like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>dirichlet_bc_app <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>apps<span style=color:#f92672>.</span>simple<span style=color:#f92672>.</span>bc_dirichlet(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;bc_dirichlet_rho&#39;</span>,
</span></span><span style=display:flex><span>                                                  values<span style=color:#f92672>=</span>[<span style=color:#ae81ff>1.0</span>],
</span></span><span style=display:flex><span>                                                  on_boundaries<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;Left&#39;</span>, <span style=color:#e6db74>&#39;Right&#39;</span>],
</span></span><span style=display:flex><span>                                                  variable<span style=color:#f92672>=</span>fluid,
</span></span><span style=display:flex><span>                                                  components<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;rho&#39;</span>])
</span></span><span style=display:flex><span>dirichlet_bc_va <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>variable_adjusters<span style=color:#f92672>.</span>boundary_conditions(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;bcs&#39;</span>,
</span></span><span style=display:flex><span>                                                               priority<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                                               spatial_order<span style=color:#f92672>=</span>sorder,
</span></span><span style=display:flex><span>                                                               applications<span style=color:#f92672>=</span>bc_apps)
</span></span><span style=display:flex><span>temporal_solver <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>host_actions<span style=color:#f92672>.</span>erk(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;rk&#39;</span>,
</span></span><span style=display:flex><span>                                         scheme<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;SSPRK3&#39;</span>,
</span></span><span style=display:flex><span>                                         spatial_solvers<span style=color:#f92672>=</span>[spatial_solver],
</span></span><span style=display:flex><span>                                         variable_adjusters<span style=color:#f92672>=</span>[dirichlet_bc_va])
</span></span></code></pre></div><p>We need to specify our spatial domain as a mesh:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Generate a 1-D mesh with 128 mesh points</span>
</span></span><span style=display:flex><span>mesh <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>mesh<span style=color:#f92672>.</span>block(Bounds<span style=color:#f92672>=</span>[<span style=color:#f92672>-</span><span style=color:#ae81ff>0.5</span>, <span style=color:#ae81ff>0.5</span>],
</span></span><span style=display:flex><span>                        NumCells<span style=color:#f92672>=</span>[<span style=color:#ae81ff>128</span>],
</span></span><span style=display:flex><span>                        NodeSets<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;Left&#39;</span>, <span style=color:#e6db74>&#39;Right&#39;</span>],
</span></span><span style=display:flex><span>                        NumLayers<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                        PeriodicBoundaries<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;Left&#39;</span>, <span style=color:#e6db74>&#39;Right&#39;</span>],
</span></span><span style=display:flex><span>                        basis_array_set<span style=color:#f92672>=</span>sorder)
</span></span></code></pre></div><p>And finally, we will want to define variable writers to periodically write variables to disk. We&rsquo;ll define a basic writer which just dumps the current fluid variables, as well as an integrator to check for mass conservation:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Basic variable writer</span>
</span></span><span style=display:flex><span>writer <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>host_actions<span style=color:#f92672>.</span>writer(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;writer&#39;</span>, ReadVars<span style=color:#f92672>=</span>[fluid])
</span></span><span style=display:flex><span><span style=color:#75715e># Diagnostic mass conservation integrator</span>
</span></span><span style=display:flex><span>integrator <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>host_actions<span style=color:#f92672>.</span>integrator(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;mass_integrator&#39;</span>,
</span></span><span style=display:flex><span>                                           time_integrator<span style=color:#f92672>=</span>temporal_solver,
</span></span><span style=display:flex><span>                                           patch_process_integrators<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>                                               warpy<span style=color:#f92672>.</span>integrators<span style=color:#f92672>.</span>dg_integrator(
</span></span><span style=display:flex><span>                                                   name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;integrator&#39;</span>,
</span></span><span style=display:flex><span>                                                   spatial_order<span style=color:#f92672>=</span>sorder,
</span></span><span style=display:flex><span>                                                   applications<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>                                                       warpy<span style=color:#f92672>.</span>apps<span style=color:#f92672>.</span>integrate<span style=color:#f92672>.</span>int_q_dv(
</span></span><span style=display:flex><span>                                                           name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;int_q_dv&#39;</span>,
</span></span><span style=display:flex><span>                                                           variables<span style=color:#f92672>=</span>fluid,
</span></span><span style=display:flex><span>                                                           stage<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                                                           variables_components<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;rho&#39;</span>])
</span></span><span style=display:flex><span>                                                   ])
</span></span><span style=display:flex><span>                                           ])
</span></span><span style=display:flex><span>diag_writer <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>host_actions<span style=color:#f92672>.</span>diagnostics_writer(
</span></span><span style=display:flex><span>    name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;diagnostics&#39;</span>,
</span></span><span style=display:flex><span>    write_interval<span style=color:#f92672>=</span><span style=color:#ae81ff>1e-3</span>,
</span></span><span style=display:flex><span>    diagnostics<span style=color:#f92672>=</span>{integrator: [<span style=color:#e6db74>&#39;integral_rho&#39;</span>]},
</span></span><span style=display:flex><span>    output_file<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;diagnostics.csv&#39;</span>)
</span></span><span style=display:flex><span>writers <span style=color:#f92672>=</span> [writer, diag_writer]
</span></span></code></pre></div><p>Now we finally have everything we need to set up our simulation!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>write_steps <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>group_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;examples&#39;</span>
</span></span><span style=display:flex><span>sim_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;advection&#39;</span>
</span></span><span style=display:flex><span>sim <span style=color:#f92672>=</span> warpy<span style=color:#f92672>.</span>dg_sim(name<span style=color:#f92672>=</span>sim_name,
</span></span><span style=display:flex><span>                   meshes<span style=color:#f92672>=</span>[mesh],
</span></span><span style=display:flex><span>                   initial_conditions<span style=color:#f92672>=</span>[ic_ha],
</span></span><span style=display:flex><span>                   temporal_solvers<span style=color:#f92672>=</span>[temporal_solver],
</span></span><span style=display:flex><span>                   writers<span style=color:#f92672>=</span>writers,
</span></span><span style=display:flex><span>                   time<span style=color:#f92672>=</span>[<span style=color:#ae81ff>0</span>, dt_final],
</span></span><span style=display:flex><span>                   dt_controller<span style=color:#f92672>=</span>dt_controller,
</span></span><span style=display:flex><span>                   flexible_writeout<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>,
</span></span><span style=display:flex><span>                   write_steps<span style=color:#f92672>=</span>write_steps,
</span></span><span style=display:flex><span>                   verbosity<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;info&#39;</span>)
</span></span></code></pre></div><p>We can write the resulting WARPXM input file to disk by calling <code>sim.write</code>:</p><pre tabindex=0><code>sim.write(f=&#34;/path/to/input/file.inp)
</code></pre><p>The resulting WARPXM input file (which we are very glad we did not have to craft by hand!) looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;warpxm&gt;</span>
</span></span><span style=display:flex><span>  Simulation = sim
</span></span><span style=display:flex><span>  NumericPrecision = double
</span></span><span style=display:flex><span>  RunName = data/advection
</span></span><span style=display:flex><span>  GlobalVerbosity = info
</span></span><span style=display:flex><span>  Verbosity = info
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;sim&gt;</span>
</span></span><span style=display:flex><span>    Type = WmSolverBase
</span></span><span style=display:flex><span>    Kind = WmSolver
</span></span><span style=display:flex><span>    Time = [0, 2.0]
</span></span><span style=display:flex><span>    Out = 100
</span></span><span style=display:flex><span>    EnableFPE = 1
</span></span><span style=display:flex><span>    FlexibleWriteout = 0
</span></span><span style=display:flex><span>    NumPartitions = 1
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;mesh&gt;</span>
</span></span><span style=display:flex><span>      Type = mesh
</span></span><span style=display:flex><span>      Kind = block
</span></span><span style=display:flex><span>      NumLayers = 1
</span></span><span style=display:flex><span>      OutputMeshPrefix = meshes/restartMesh
</span></span><span style=display:flex><span>      Bounds = [-0.5, 0.5]
</span></span><span style=display:flex><span>      NumCells = [128]
</span></span><span style=display:flex><span>      NodeSets = [Left, Right]
</span></span><span style=display:flex><span>      PeriodicBoundaries = [Left, Right]
</span></span><span style=display:flex><span>      NodalMeshPrefix = meshes/plotMesh
</span></span><span style=display:flex><span>      BasisArraySet = thirdOrder
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/mesh&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;dt_controller&gt;</span>
</span></span><span style=display:flex><span>      Type = WmHostAction
</span></span><span style=display:flex><span>      Kind = time_stepper.fixed_dt
</span></span><span style=display:flex><span>      InitDt = 0.0001
</span></span><span style=display:flex><span>      CheckCFL = 1
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/dt_controller&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;fluid&gt;</span>
</span></span><span style=display:flex><span>      Type = variable
</span></span><span style=display:flex><span>      Kind = distributed
</span></span><span style=display:flex><span>      ComponentNames = [rho]
</span></span><span style=display:flex><span>      BasisArraySet = thirdOrder
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/fluid&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;fluid_1&gt;</span>
</span></span><span style=display:flex><span>      Type = variable
</span></span><span style=display:flex><span>      Kind = distributed
</span></span><span style=display:flex><span>      ComponentNames = [rho]
</span></span><span style=display:flex><span>      BasisArraySet = thirdOrder
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/fluid_1&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;fluid_2&gt;</span>
</span></span><span style=display:flex><span>      Type = variable
</span></span><span style=display:flex><span>      Kind = distributed
</span></span><span style=display:flex><span>      ComponentNames = [rho]
</span></span><span style=display:flex><span>      BasisArraySet = thirdOrder
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/fluid_2&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;fluid_3&gt;</span>
</span></span><span style=display:flex><span>      Type = variable
</span></span><span style=display:flex><span>      Kind = distributed
</span></span><span style=display:flex><span>      ComponentNames = [rho]
</span></span><span style=display:flex><span>      BasisArraySet = thirdOrder
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/fluid_3&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;diagnostics&gt;</span>
</span></span><span style=display:flex><span>      Type = WmHostAction
</span></span><span style=display:flex><span>      Kind = diagnostics_writer
</span></span><span style=display:flex><span>      WriteInterval = 0.001
</span></span><span style=display:flex><span>      OutputFile = diagnostics.csv
</span></span><span style=display:flex><span>      mass_integrator_SampleNames = [integral_rho]
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;mass_integrator&gt;</span>
</span></span><span style=display:flex><span>        Type = WmHostAction
</span></span><span style=display:flex><span>        Kind = integrator
</span></span><span style=display:flex><span>        QOld = [fluid.rho]
</span></span><span style=display:flex><span>        QStorage0 = [fluid_1.rho]
</span></span><span style=display:flex><span>        QStorage1 = [fluid_2.rho]
</span></span><span style=display:flex><span>        QStorage2 = [fluid_3.rho]
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;integrator&gt;</span>
</span></span><span style=display:flex><span>          Process = dg_integrator
</span></span><span style=display:flex><span>          Type = WmHostAction
</span></span><span style=display:flex><span>          Kind = patchProcessor
</span></span><span style=display:flex><span>          BasisArraySet = thirdOrder
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;int_q_dv&gt;</span>
</span></span><span style=display:flex><span>            Type = application
</span></span><span style=display:flex><span>            Kind = int_q_dv
</span></span><span style=display:flex><span>            Stage = 0
</span></span><span style=display:flex><span>            Vars = [0]
</span></span><span style=display:flex><span>          <span style=color:#f92672>&lt;/int_q_dv&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/integrator&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;/mass_integrator&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/diagnostics&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;writer&gt;</span>
</span></span><span style=display:flex><span>      Type = WmHostAction
</span></span><span style=display:flex><span>      Kind = writeOut
</span></span><span style=display:flex><span>      ReadVars = [fluid]
</span></span><span style=display:flex><span>      WriteInterval = 1
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/writer&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;ic_ha&gt;</span>
</span></span><span style=display:flex><span>      Type = WmHostAction
</span></span><span style=display:flex><span>      Kind = va_runner
</span></span><span style=display:flex><span>      Vars = [fluid.rho]
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;ic_va&gt;</span>
</span></span><span style=display:flex><span>        Process = function_evaluator
</span></span><span style=display:flex><span>        Type = WmHostAction
</span></span><span style=display:flex><span>        Kind = patchProcessor
</span></span><span style=display:flex><span>        BasisArraySet = thirdOrder
</span></span><span style=display:flex><span>        Priority = 0
</span></span><span style=display:flex><span>        OnSubdomains = [all]
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;fluid_ic&gt;</span>
</span></span><span style=display:flex><span>          Type = application
</span></span><span style=display:flex><span>          Kind = heaviside_app
</span></span><span style=display:flex><span>          LeftValue = 0.1
</span></span><span style=display:flex><span>          RightValue = 0.6
</span></span><span style=display:flex><span>          OutputVariables = [0]
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/fluid_ic&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;/ic_va&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/ic_ha&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;rk&gt;</span>
</span></span><span style=display:flex><span>      Type = WmHostAction
</span></span><span style=display:flex><span>      Kind = explicit_runge_kutta
</span></span><span style=display:flex><span>      Scheme = SSPRK3
</span></span><span style=display:flex><span>      QOld = [fluid.rho]
</span></span><span style=display:flex><span>      QStorage0 = [fluid_1.rho]
</span></span><span style=display:flex><span>      QStorage1 = [fluid_2.rho]
</span></span><span style=display:flex><span>      QStorage2 = [fluid_3.rho]
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;dg&gt;</span>
</span></span><span style=display:flex><span>        Process = spatial_solver.dg
</span></span><span style=display:flex><span>        Type = WmHostAction
</span></span><span style=display:flex><span>        Kind = patchProcessor
</span></span><span style=display:flex><span>        BasisArraySet = thirdOrder
</span></span><span style=display:flex><span>        SourceQuadratureStyle = LGL
</span></span><span style=display:flex><span>        OnSubdomains = [all]
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;advection&gt;</span>
</span></span><span style=display:flex><span>          Type = application
</span></span><span style=display:flex><span>          Kind = advection
</span></span><span style=display:flex><span>          Velocity = [1.0, 0.0, 0.0]
</span></span><span style=display:flex><span>          Density = [0]
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/advection&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;/dg&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/rk&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;vloader&gt;</span>
</span></span><span style=display:flex><span>      Type = WmHostAction
</span></span><span style=display:flex><span>      Kind = variableLoader
</span></span><span style=display:flex><span>      SourceFilePrefix = data/advection
</span></span><span style=display:flex><span>      WriteVars = [fluid]
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/vloader&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;gsync&gt;</span>
</span></span><span style=display:flex><span>      Type = WmHostAction
</span></span><span style=display:flex><span>      Kind = synchronizer
</span></span><span style=display:flex><span>      WriteVars = [fluid]
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/gsync&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;swapper&gt;</span>
</span></span><span style=display:flex><span>      Type = WmHostAction
</span></span><span style=display:flex><span>      Kind = variableSwapper
</span></span><span style=display:flex><span>      WriteVars = [fluid, fluid_3]
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/swapper&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;perstep_group&gt;</span>
</span></span><span style=display:flex><span>      Type = WmSequencedGroup
</span></span><span style=display:flex><span>      Kind = hostSequencedGroup
</span></span><span style=display:flex><span>      HostActions = [rk]
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/perstep_group&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;start_only_group&gt;</span>
</span></span><span style=display:flex><span>      Type = WmSequencedGroup
</span></span><span style=display:flex><span>      Kind = hostSequencedGroup
</span></span><span style=display:flex><span>      HostActions = [ic_ha, gsync]
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/start_only_group&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;write_group&gt;</span>
</span></span><span style=display:flex><span>      Type = WmSequencedGroup
</span></span><span style=display:flex><span>      Kind = hostSequencedGroup
</span></span><span style=display:flex><span>      HostActions = [writer, diagnostics]
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/write_group&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;vload_group&gt;</span>
</span></span><span style=display:flex><span>      Type = WmSequencedGroup
</span></span><span style=display:flex><span>      Kind = hostSequencedGroup
</span></span><span style=display:flex><span>      HostActions = [vloader, gsync]
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/vload_group&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;swap_group&gt;</span>
</span></span><span style=display:flex><span>      Type = WmSequencedGroup
</span></span><span style=display:flex><span>      Kind = hostSequencedGroup
</span></span><span style=display:flex><span>      HostActions = [swapper]
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/swap_group&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;SolverSequence&gt;</span>
</span></span><span style=display:flex><span>      Type = WmSolverSequence
</span></span><span style=display:flex><span>      StartOnly = [start_only_group]
</span></span><span style=display:flex><span>      PerStep = [write_group, perstep_group, swap_group]
</span></span><span style=display:flex><span>      PreRedoPerStep = [swap_group]
</span></span><span style=display:flex><span>      EndOnly = [write_group]
</span></span><span style=display:flex><span>      Restart = [vload_group]
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/SolverSequence&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/sim&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/warpxm&gt;</span>
</span></span></code></pre></div><p>We can use <code>sim.run()</code> to immediately run <code>warpxm</code> with the generated input:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>sim<span style=color:#f92672>.</span>run(category<span style=color:#f92672>=</span>group_name)
</span></span></code></pre></div><pre tabindex=0><code>$ python examples/advection_1d.py
Execution command is:  /warpxm/build/bin/warpxm -i /warpxm/build/user_runs/evan_bluhm/examples/advection/advection.inp
Process id:38684 is 1 of 1 processes
Simulation started at time Thu Jun  1 10:19:04 2023

Advancing solution starting at time 0 to 0.02...
Advanced from frame 0 to 1 in 0.137 seconds,
with dt = 0.0001

Advancing solution starting at time 0.02 to 0.04...
Advanced from frame 1 to 2 in 0.105 seconds,
with dt = 0.0001

Advancing solution starting at time 0.04 to 0.06...
Advanced from frame 2 to 3 in 0.104 seconds,
with dt = 0.0001

Advancing solution starting at time 0.06 to 0.08...
Advanced from frame 3 to 4 in 0.104 seconds,
with dt = 0.0001

...

Advancing solution starting at time 1.96 to 1.98...
Advanced from frame 98 to 99 in 0.105 seconds,
with dt = 0.0001

Advancing solution starting at time 1.98 to 2...
Advanced from frame 99 to 100 in 0.106 seconds,
with dt = 0.0001

Simulation finished at time Thu Jun  1 10:19:14 2023
</code></pre><h1 id=debugging>Debugging
<a class=anchor href=#debugging>#</a></h1><p>Debugging is an inevitable fact of life when it comes to numerical codes (or any software for that matter). There are many different methods for debugging both C++ and Python projects, and the methods you choose mostly come down to what is most comfortable to your own development process. Here are some methods I have been using to debug WARPXM simulations:</p><h2 id=excessive-stdout>Excessive stdout
<a class=anchor href=#excessive-stdout>#</a></h2><p>Simply printing loads of information to the console is a pretty basic method, but it&rsquo;s very often the quickest way to figure out what might be going wrong.</p><p>When working within the C++ <code>warpxm</code> code, there are logger streams set up which allow printing information to the console at different logging levels. The two logging levels you will generally use are the &ldquo;info&rdquo; and &ldquo;debug&rdquo; streams:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c++ data-lang=c++><span style=display:flex><span>WxLogger<span style=color:#f92672>*</span> log <span style=color:#f92672>=</span> WxLogger<span style=color:#f92672>::</span>get(<span style=color:#e6db74>&#34;warpx-root.console&#34;</span>);
</span></span><span style=display:flex><span>WxLogStream infStrm <span style=color:#f92672>=</span> log<span style=color:#f92672>-&gt;</span>getInfoStream();
</span></span><span style=display:flex><span>WxLogStream debStrm <span style=color:#f92672>=</span> log<span style=color:#f92672>-&gt;</span>getDebugStream();
</span></span><span style=display:flex><span>infStrm <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;This log will appear in stdout with verbosity set to &#39;info&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>debStrm <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;This log will appear in stdout with verbosity set to &#39;debug&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span></code></pre></div><p>The log verbosity can be set as the <code>verbosity</code> parameter to a <code>warpy.simulation</code>, or directly within the .inp file.</p><p>When working with warpy modules in Python, you can just use the built-in <code>print</code> method to write to stdout at any point in your script.
<a href=https://docs.python.org/3/tutorial/inputoutput.html>Python f-strings</a> are a convenient way to format strings containing multiple variables:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>print(<span style=color:#e6db74>&#34;This line will be printed to the console&#34;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;The time-stepping order is </span><span style=color:#e6db74>{</span>torder<span style=color:#e6db74>}</span><span style=color:#e6db74> and the DG polynomial basis order is </span><span style=color:#e6db74>{</span>sorder<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h2 id=attaching-debugger-c-in-vs-code-with-gdb-or-lldb>Attaching Debugger: C++ in VS Code with <code>gdb</code> or <code>lldb</code>
<a class=anchor href=#attaching-debugger-c-in-vs-code-with-gdb-or-lldb>#</a></h2><p>It is possible to configure VS Code to work as a fully-featured C++ debugger, using the
<a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools">ms-vscode.cpptools extension</a> and a supported C++ debugger (either <code>gdb</code> or <code>lldb</code>).</p><ol><li>Prepare a WARPXM input file using <code>warpy.simulation.write()</code>.</li><li>Set up a debugging configuration within your workspace&rsquo;s <code>launch.json</code>. If there is no <code>launch.json</code> in your workspace yet, you can simply create a new file named <code>$(/path/to/warpxm/repo).vscode/launch.json</code>. Add a <code>cppdb</code> configuration to the file:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;0.2.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;configurations&#34;</span>: [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;lldb warpxm&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;cppdbg&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;request&#34;</span>: <span style=color:#e6db74>&#34;launch&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#75715e>// This is the path to the warpxm executable, automatically resolved by CMake Tools:
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#f92672>&#34;program&#34;</span>: <span style=color:#e6db74>&#34;${command:cmake.launchTargetPath}&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Path to the WARPXM input file you want to run
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#f92672>&#34;args&#34;</span>: [<span style=color:#e6db74>&#34;-i&#34;</span>, <span style=color:#e6db74>&#34;/warpxm/build/user_runs/evan_bluhm/examples/advection/advection.inp&#34;</span>],
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;stopAtEntry&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Set the current working directly when launching warpxm to the same folder as the input file
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#f92672>&#34;cwd&#34;</span>: <span style=color:#e6db74>&#34;${workspaceFolder}/build/user_runs/evan_bluhm/examples/advection&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;environment&#34;</span>: [
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// add the directory where our target was built to the PATHs
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#75715e>// it gets resolved by CMake Tools:
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;PATH&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;value&#34;</span>: <span style=color:#e6db74>&#34;${env:PATH}:${command:cmake.getLaunchTargetDirectory}&#34;</span>
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            ],
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;MIMode&#34;</span>: <span style=color:#e6db74>&#34;lldb&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;setupCommands&#34;</span>: [
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;Enable pretty-printing for lldb&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;text&#34;</span>: <span style=color:#e6db74>&#34;-enable-pretty-printing&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;ignoreFailures&#34;</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>Make sure to select either the <code>Debug</code> or <code>RelWithDebInfo</code> variant of the project. You can switch the CMake variant using the <code>CMake: Select Variant</code> command. Make sure to re-build after switching between variants!</li><li>Set a breakpoint anywhere in the code by clicking just to the left of the line numbers in the gutter.</li><li>Press F5 or go to the &ldquo;Run and Debug&rdquo; menu to launch the new <code>lldb warpxm</code> target. It will immediately launch <code>warpxm</code>. When the running executable hits your breakpoint, it should immediately take your editor to the breakpoint, giving you the ability to view all local variables, step forwards through the code, and set additional breakpoints.</li></ol><p align=center><img alt=img/research/warpxm/warpxm-debug-1.png src=/r/img/research/warpxm/warpxm-debug-1.png></p><p>You can use the &ldquo;Debug console&rdquo; to evaluate gdb/lldb commands while paused at a breakpoint.</p><h2 id=attaching-debugger-c-with-gdb>Attaching Debugger: C++ with <code>gdb</code>
<a class=anchor href=#attaching-debugger-c-with-gdb>#</a></h2><p>TODO!</p><h2 id=attaching-debugger-python-in-vs-code-with-debugpy>Attaching Debugger: Python in VS Code with <code>debugpy</code>
<a class=anchor href=#attaching-debugger-python-in-vs-code-with-debugpy>#</a></h2><p>Similar to using the C++ extension to use VS Code as a C++ debugger, you can use the built-in Python extension to do the same for warpy modules.</p><ol><li>Set up a debugging configuration within your workspace&rsquo;s <code>launch.json</code>. If there is no <code>launch.json</code> in your workspace yet, you can simply create a new file named <code>$(/path/to/warpxm/repo).vscode/launch.json</code>. Add a <code>cppdb</code> configuration to the file:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;0.2.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;configurations&#34;</span>: [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Debug python file&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;python&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;request&#34;</span>: <span style=color:#e6db74>&#34;launch&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Path to the warpy script you want to launch and debug
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#f92672>&#34;program&#34;</span>: <span style=color:#e6db74>&#34;build/user_runs/evan_bluhm/examples/advection_1d.py&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;console&#34;</span>: <span style=color:#e6db74>&#34;integratedTerminal&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;justMyCode&#34;</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=2><li>Set a breakpoint anywhere in the code by clicking just to the left of the line numbers in the gutter.</li><li>Press F5 or go to the &ldquo;Run and Debug&rdquo; menu to launch the new &ldquo;Debug python file&rdquo; target. It will immediately run the warpy script in the integrated terminal. When the running executable hits your breakpoint, it should immediately take your editor to the breakpoint, giving you the ability to view all local variables, step forwards through the code, and set additional breakpoints.</li></ol><p align=center><img alt=img/research/warpxm/warpy-debug-1.png src=/r/img/research/warpxm/warpy-debug-1.png></p><p>You can use the &ldquo;Debug console&rdquo; to evaluate arbitrary expressions while paused at a breakpoint.</p><h2 id=attaching-debugger-pdb>Attaching Debugger: <code>pdb</code>
<a class=anchor href=#attaching-debugger-pdb>#</a></h2><p>The built-in command-line Python debugger module <code>pdb</code> can be used to debug Python scripts at the command-line. Simply insert this line wherever you would like to break execution:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pdb; pdb<span style=color:#f92672>.</span>set_trace()
</span></span></code></pre></div><p>and launch your script. Execution will pause at the breakpoint:</p><pre tabindex=0><code>python examples/advection_1d.py
&gt; /Users/evan/GitHub/warpxm/build/user_runs/evan_bluhm/examples/advection_1d.py(149)&lt;module&gt;()
-&gt; if run_sim:
(Pdb)
</code></pre><p>You can now run <code>pdb</code> commands. Type <code>?</code> to see a list of available commands:</p><pre tabindex=0><code>(Pdb) ?

Documented commands (type help &lt;topic&gt;):
========================================
EOF    c          d        h         list      q        rv       undisplay
a      cl         debug    help      ll        quit     s        unt
alias  clear      disable  ignore    longlist  r        source   until
args   commands   display  interact  n         restart  step     up
b      condition  down     j         next      return   tbreak   w
break  cont       enable   jump      p         retval   u        whatis
bt     continue   exit     l         pp        run      unalias  where

Miscellaneous help topics:
==========================
exec  pdb
</code></pre><p>You can view the current value of any variable by typing its name, or using the <code>print()</code> function:</p><pre tabindex=0><code>(Pdb) write_steps
100
</code></pre></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/Peppyhare/r/commit/0f0e74320f4f24cdd707b06972f36cc68439affb title='Last modified by Evan Bluhm | June 8, 2023' target=_blank rel=noopener><img src=/r/svg/calendar.svg class=book-icon alt=Calendar>
<span>June 8, 2023</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#what-is-warpxm>What is WARPXM</a></li><li><a href=#installation>Installation</a><ul><li><a href=#source>Source</a></li><li><a href=#prerequisites-warpxm>Prerequisites: WARPXM</a></li><li><a href=#prerequisites-warpy>Prerequisites: Warpy</a></li><li><a href=#build---vscode>Build - VSCode</a></li><li><a href=#build---command-line>Build - Command-line</a></li></ul></li><li><a href=#basic-example>Basic Example</a></li><li><a href=#debugging>Debugging</a><ul><li><a href=#excessive-stdout>Excessive stdout</a></li><li><a href=#attaching-debugger-c-in-vs-code-with-gdb-or-lldb>Attaching Debugger: C++ in VS Code with <code>gdb</code> or <code>lldb</code></a></li><li><a href=#attaching-debugger-c-with-gdb>Attaching Debugger: C++ with <code>gdb</code></a></li><li><a href=#attaching-debugger-python-in-vs-code-with-debugpy>Attaching Debugger: Python in VS Code with <code>debugpy</code></a></li><li><a href=#attaching-debugger-pdb>Attaching Debugger: <code>pdb</code></a></li></ul></li></ul></nav></div></aside></main></body></html>