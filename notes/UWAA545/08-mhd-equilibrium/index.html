<!doctype html><html lang=en dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="MHD Equilibrium Calculations# From physical expectations, elliptic equations result from equilibrium calculations and eigenvalue systems. In general, we can write elliptic equations as \[\vec A \vec x = \vec b\] where \( \vec A \) may be a nonlinear function of \( \vec x \). For example, if we think of Poisson’s equation in 1D, \[\dv{^2 \phi}{x^2} = - \rho_c\] and apply finite differencing, \[\frac{\phi_{j+1} - 2 \phi_j + \phi_{j-1}}{\Delta x^2} = - \rho_j\] we get a matrix system \[\vec A \vec x = \frac{1}{\Delta x^2} \begin{bmatrix} -2 & 1 & 0 & \ldots \\ 1 & -2 & 1 & \ldots \\ \ldots & \ldots & \ldots & \ldots \end{bmatrix} \begin{bmatrix} \phi_1 \\ \phi_2 \\ \ldots \end{bmatrix} = \vec b = - \begin{bmatrix} \rho_1 \\ \rho_2 \\ \ldots \end{bmatrix}\] where \( \vec A \) is a J by J matrix. In equilibrium calculations, this comes up when solving the Grad-Shafranov equation
"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://peppyhare.github.io/r/notes/UWAA545/08-mhd-equilibrium/"><meta property="og:site_name" content="My Notes"><meta property="og:title" content="MHD Equilibrium Calculations"><meta property="og:description" content="MHD Equilibrium Calculations# From physical expectations, elliptic equations result from equilibrium calculations and eigenvalue systems. In general, we can write elliptic equations as \[\vec A \vec x = \vec b\] where \( \vec A \) may be a nonlinear function of \( \vec x \). For example, if we think of Poisson’s equation in 1D, \[\dv{^2 \phi}{x^2} = - \rho_c\] and apply finite differencing, \[\frac{\phi_{j+1} - 2 \phi_j + \phi_{j-1}}{\Delta x^2} = - \rho_j\] we get a matrix system \[\vec A \vec x = \frac{1}{\Delta x^2} \begin{bmatrix} -2 & 1 & 0 & \ldots \\ 1 & -2 & 1 & \ldots \\ \ldots & \ldots & \ldots & \ldots \end{bmatrix} \begin{bmatrix} \phi_1 \\ \phi_2 \\ \ldots \end{bmatrix} = \vec b = - \begin{bmatrix} \rho_1 \\ \rho_2 \\ \ldots \end{bmatrix}\] where \( \vec A \) is a J by J matrix. In equilibrium calculations, this comes up when solving the Grad-Shafranov equation"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="notes"><meta property="article:modified_time" content="2026-01-29T13:06:53-08:00"><meta itemprop=name content="MHD Equilibrium Calculations"><meta itemprop=description content="MHD Equilibrium Calculations# From physical expectations, elliptic equations result from equilibrium calculations and eigenvalue systems. In general, we can write elliptic equations as \[\vec A \vec x = \vec b\] where \( \vec A \) may be a nonlinear function of \( \vec x \). For example, if we think of Poisson’s equation in 1D, \[\dv{^2 \phi}{x^2} = - \rho_c\] and apply finite differencing, \[\frac{\phi_{j+1} - 2 \phi_j + \phi_{j-1}}{\Delta x^2} = - \rho_j\] we get a matrix system \[\vec A \vec x = \frac{1}{\Delta x^2} \begin{bmatrix} -2 & 1 & 0 & \ldots \\ 1 & -2 & 1 & \ldots \\ \ldots & \ldots & \ldots & \ldots \end{bmatrix} \begin{bmatrix} \phi_1 \\ \phi_2 \\ \ldots \end{bmatrix} = \vec b = - \begin{bmatrix} \rho_1 \\ \rho_2 \\ \ldots \end{bmatrix}\] where \( \vec A \) is a J by J matrix. In equilibrium calculations, this comes up when solving the Grad-Shafranov equation"><meta itemprop=dateModified content="2026-01-29T13:06:53-08:00"><meta itemprop=wordCount content="2511"><title>MHD Equilibrium Calculations | My Notes</title><link rel=icon href=/r/favicon.png><link rel=manifest href=/r/manifest.json><link rel=canonical href=https://peppyhare.github.io/r/notes/UWAA545/08-mhd-equilibrium/><link rel=stylesheet href=/r/book.min.ba28f313a83446a28b57b814dee23b24f1f381a68a01c0464ef5577ab2f61ded.css integrity="sha256-uijzE6g0RqKLV7gU3uI7JPHzgaaKAcBGTvVXerL2He0=" crossorigin=anonymous><script defer src=/r/fuse.min.js></script><script defer src=/r/en.search.min.5d518feacf9f5e7b2a68534d5167781d8074aeb7747c131300edeaf112598b79.js integrity="sha256-XVGP6s+fXnsqaFNNUWd4HYB0rrd0fBMTAO3q8RJZi3k=" crossorigin=anonymous></script><script defer src=/r/sw.min.9e3a83f0b071ebe0141a16a33db93faadb2bdf712473a218febeed35ed243c08.js integrity="sha256-njqD8LBx6+AUGhajPbk/qtsr33Ekc6IY/r7tNe0kPAg=" crossorigin=anonymous></script><link rel=preload href=/r/katex/fonts/KaTeX_Main-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Main-Bold.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Main-Italic.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Math-Italic.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Size2-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Size3-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/fonts/roboto-v27-latin-regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/fonts/roboto-v27-latin-700.woff2 as=font type=font/woff2 crossorigin=anonymous></head><body dir=ltr class="book-kind-page book-type-notes"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/r/><span>My Notes</span></a></h2><div class="book-search hidden"><input id=book-search-input type=text placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class=flex><a role=button><img src=/r/icons/translate.svg class=book-icon alt=Languages>
English
</a><img src=/r/icons/chevron-right.svg class=book-icon alt=Expand></label><ul></ul></li></ul><ul><li class=book-section-flat><a>Notes</a><ul><li class=book-section-flat><input type=checkbox id=section-f04c181c9b16a37431fe06303d58b7a0 class=toggle checked>
<label for=section-f04c181c9b16a37431fe06303d58b7a0 class=flex><a href=/r/notes/UWAA545/>Computational Methods For Plasmas</a>
<img src=/r/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/r/notes/UWAA545/01-syllabus/>Syllabus</a></li><li><a href=/r/notes/UWAA545/02-plasma-models/>Plasma Models</a></li><li><a href=/r/notes/UWAA545/03-pic-method/>Particle in Cell Model</a></li><li><a href=/r/notes/UWAA545/04-pic-example/>PIC - Example Implementation</a></li><li><a href=/r/notes/UWAA545/05-electrodynamic-pic/>Multidimensional Electrodynamic PIC</a></li><li><a href=/r/notes/UWAA545/06-fluid-models/>Fluid Models for Plasmas</a></li><li><a href=/r/notes/UWAA545/07-finite-difference-models/>Finite Difference Methods for MHD</a></li><li><a href=/r/notes/UWAA545/08-mhd-equilibrium/ class=active>MHD Equilibrium Calculations</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-b6bdf3598cf4214623cd2f8ff7b6e0f2 class=toggle>
<label for=section-b6bdf3598cf4214623cd2f8ff7b6e0f2 class=flex><a href=/r/notes/UWAA560/>Plasma Diagnostics</a>
<img src=/r/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/r/notes/UWAA560/01-syllabus/>Syllabus</a></li><li><a href=/r/notes/UWAA560/02-diagnostic-considerations/>General Diagnostic Considerations</a></li><li><a href=/r/notes/UWAA560/03-magnetic-field-diagnostics/>Magnetic Field Diagnostics</a></li><li><a href=/r/notes/UWAA560/04-electrostatic-diagnostics/>Electrostatic Diagnostics</a></li><li><a href=/r/notes/UWAA560/05-index-of-refraction-measurements/>Index of Refraction Measurements</a></li><li><a href=/r/notes/UWAA560/06-spectroscopic-measurements/>Spectroscopic Measurements</a></li><li><a href=/r/notes/UWAA560/90-student-lectures/>Student Lectures</a></li><li><a href=/r/notes/UWAA560/91-zeeman-spectroscopy/>My class lecture</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-5b051410be8cdb0f46ad32fc2ad5a20d class=toggle>
<label for=section-5b051410be8cdb0f46ad32fc2ad5a20d class=flex><a href=/r/notes/UWAA558/>MHD Theory</a>
<img src=/r/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/r/notes/UWAA558/01-syllabus/>Syllabus</a></li><li><a href=/r/notes/UWAA558/02-plasma-models/>Plasma Models</a></li><li><a href=/r/notes/UWAA558/03-plasma-fluid-model/>Plasma Fluid Model</a></li><li><a href=/r/notes/UWAA558/04-two-fluid-plasma-model/>Two-Fluid Plasma Model</a></li><li><a href=/r/notes/UWAA558/05-mhd-model/>Magnetohydrodynamic (MHD) Model</a></li><li><a href=/r/notes/UWAA558/06-boundary-conditions/>Boundary Conditions</a></li><li><a href=/r/notes/UWAA558/07-equilibrium-for-fusion/>Equilibrium for Fusion</a></li><li><a href=/r/notes/UWAA558/08-1d-equilibria/>1-D Equilibria</a></li><li><a href=/r/notes/UWAA558/09-2d-equilibria/>2D Equilibria</a></li><li><a href=/r/notes/UWAA558/10-equilibrium-of-3d-configurations/>Equilibrium of 3D Configurations</a></li><li><a href=/r/notes/UWAA558/11-mhd-stability/>MHD Stability</a></li><li><a href=/r/notes/UWAA558/formulary/>Formulary</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-c3201a1057283cb12ab09a42fe89bfb2 class=toggle>
<label for=section-c3201a1057283cb12ab09a42fe89bfb2 class=flex><a href=/r/notes/research/>Research Notes</a>
<img src=/r/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/r/notes/research/apollo/>Apollo dynamic tuning framework for RAJA</a></li><li><a href=/r/notes/research/dgh-datta/>Electrodynamic Dory-Guest-Harris Instability</a></li><li><a href=/r/notes/research/install-tricks/>Installation tricks</a></li><li><a href=/r/notes/research/valgrind/>Valgrind</a></li><li><a href=/r/notes/research/warpxm-101/>WARPXM 101 - Getting Started</a></li><li><a href=/r/notes/research/warpxm-102/>WARPXM 102 - Code Structure</a></li><li><a href=/r/notes/research/warpxm-201/>WARPXM 201 - Unstructured Geometry</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-e5101c35c8277102365bd86ab3e99a0d class=toggle>
<label for=section-e5101c35c8277102365bd86ab3e99a0d class=flex><a href=/r/notes/UWAMATH567/>Applied Complex Analysis</a>
<img src=/r/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/r/notes/UWAMATH567/01-overview/>Overview</a></li><li><a href=/r/notes/UWAMATH567/02-complex-numbers/>Complex Numbers</a></li><li><a href=/r/notes/UWAMATH567/03-analytic-functions/>Analytic Functions and Integration</a></li><li><a href=/r/notes/UWAMATH567/04-series/>Sequences, series, and singularities</a></li><li><a href=/r/notes/UWAMATH567/05-residue-calculus/>Residue calculus and applications of contour integration</a></li><li><a href=/r/notes/UWAMATH567/06-real-integrals/>Real Integrals</a></li><li><a href=/r/notes/UWAMATH567/07-integrals-of-multivalued-functions/>Integrals of Multivalued Functions</a></li><li><a href=/r/notes/UWAMATH567/08-fourier-transform/>Fourier Transforms and Laplace Transforms</a></li><li><a href=/r/notes/UWAMATH567/09-conformal-mapping/>Conformal Mappings</a></li><li><a href=/r/notes/UWAMATH567/10-fluid-flow/>Fluid Flow</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-34991d35561e8d266d64d5d323e97c7a class=toggle>
<label for=section-34991d35561e8d266d64d5d323e97c7a class=flex><a href=/r/notes/UWAA557/>Physics of Fusion Plasmas</a>
<img src=/r/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/r/notes/UWAA557/ch10-0/>Rules of thumb</a></li><li><a href=/r/notes/UWAA557/ch10-1/>Statistical Mechanics</a></li><li><a href=/r/notes/UWAA557/ch10-2/>Review of E&amp;M</a></li><li><a href=/r/notes/UWAA557/ch10-3/>Lagrange Multipliers</a></li><li><a href=/r/notes/UWAA557/ch11-1/>Wall-supported Plasma</a></li><li><a href=/r/notes/UWAA557/ch11-2/>Collisions</a></li><li><a href=/r/notes/UWAA557/ch11-3/>Oscillations</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-7c7b4e4d4494a744744faedd969cb670 class=toggle>
<label for=section-7c7b4e4d4494a744744faedd969cb670 class=flex><a href=/r/notes/UWAA543/>Computational CFD</a>
<img src=/r/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/r/notes/UWAA543/ch20-1/>Introduction to Computational CFD</a></li><li><a href=/r/notes/UWAA543/ch20-2/>Governing Equations</a></li><li><a href=/r/notes/UWAA543/ch20-3/>Reduced Models</a></li><li><a href=/r/notes/UWAA543/ch20-4/>Equation Types</a></li><li><a href=/r/notes/UWAA543/ch20-5/>Panel Method</a></li><li><a href=/r/notes/UWAA543/ch21-1/>Finite Difference Algorithms</a></li><li><a href=/r/notes/UWAA543/ch21-2/>Explicit Finite Difference Algorithms</a></li><li><a href=/r/notes/UWAA543/ch21-3/>Finite Difference and Finite Volume Methods</a></li><li><a href=/r/notes/UWAA543/ch21-4/>Implicit Algorithms</a></li><li><a href=/r/notes/UWAA543/ch21-5/>Numerical Boundary Conditions</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-e5f141895443fc824f58730f7904d483 class=toggle>
<label for=section-e5f141895443fc824f58730f7904d483 class=flex><a href=/r/notes/UWAA556/>Plasma Waves</a>
<img src=/r/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/r/notes/UWAA556/ch01-1/>Mathematical review</a></li><li><a href=/r/notes/UWAA556/ch02-1/>Plasma Waves in General Dielectric Media</a></li><li><a href=/r/notes/UWAA556/ch02-2/>Wave Properties in Cold Unmagnetized Plasma</a></li><li><a href=/r/notes/UWAA556/ch02-3/>Cold Magnetized Plasma Dispersion Relation</a></li><li><a href=/r/notes/UWAA556/ch02-4/>The CMA Diagram</a></li><li><a href=/r/notes/UWAA556/ch03-1/>Introduction to Kinetic Theory</a></li><li><a href=/r/notes/UWAA556/ch03-2/>Landau Damping</a></li><li><a href=/r/notes/UWAA556/ch03-3/>Waves in Hot Magnetized Plasma</a></li><li><a href=/r/notes/UWAA556/ch04-1/>Fluid stuff</a></li><li><a href=/r/notes/UWAA556/ch04-2/>Quasi-Linear Theory</a></li><li><a href=/r/notes/UWAA556/ch05-1/>Diffusion and Resistivity</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-3a2759a8b11b3422da800ed19897932a class=toggle>
<label for=section-3a2759a8b11b3422da800ed19897932a class=flex><a href=/r/notes/problems/>Worked Problems</a>
<img src=/r/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/r/notes/problems/gurnett/ch02/>Characteristic Parameters of a Plasma</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-05ac7760b68f0e0530d0e609833f6902 class=toggle>
<label for=section-05ac7760b68f0e0530d0e609833f6902 class=flex><a role=button>Scratch</a>
<img src=/r/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/r/notes/scratch/colors/>Adding Color</a></li><li><a href=/r/notes/scratch/crews2018/>Crews (2018)</a></li><li><a href=/r/notes/scratch/datta2021/>Datta (2021)</a></li><li><a href=/r/notes/scratch/drawing/>Drawing Diagrams</a></li><li><a href=/r/notes/scratch/goedbloed/>Goedbloed (2019)</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-c8688d5789736c2ae128963cf705a441 class=toggle>
<label for=section-c8688d5789736c2ae128963cf705a441 class=flex><a href=/r/notes/griffiths/>Griffiths Introduction to Electrodynamics</a>
<img src=/r/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/r/notes/griffiths/ch1-1/>(1.1) Vector Algebra</a></li><li><a href=/r/notes/griffiths/ch1-2/>(1.2) Differential Calculus</a></li><li><a href=/r/notes/griffiths/ch1-3/>(1.3) Integral Calculus</a></li><li><a href=/r/notes/griffiths/ch1-4/>(1.4) Curvilinear Coordinates</a></li><li><a href=/r/notes/griffiths/ch1-5/>(1.5) The Dirac Delta Function</a></li><li><a href=/r/notes/griffiths/ch1-6/>(1.6) The Theory of Vector Fields</a></li><li><a href=/r/notes/griffiths/ch2-1/>(2.1) The Electric Field</a></li><li><a href=/r/notes/griffiths/ch2-2/>(2.2) Divergence and Curl of Electrostatic Fields</a></li><li><a href=/r/notes/griffiths/ch2-3/>(2.3) Electric Potential</a></li><li><a href=/r/notes/griffiths/ch2-4/>(2.4) Work and Energy in Electrostatics</a></li><li><a href=/r/notes/griffiths/ch2-5/>(2.5) Conductors</a></li><li><a href=/r/notes/griffiths/ch3-1/>(3.1) Laplace's Equation</a></li><li><a href=/r/notes/griffiths/ch3-2/>(3.2) The Method of Images</a></li><li><a href=/r/notes/griffiths/ch3-3/>(3.3) Separation of Variables</a></li><li><a href=/r/notes/griffiths/ch3-4/>(3.4) Multipole Expansion</a></li><li><a href=/r/notes/griffiths/ch4-1/>(4.1) Polarization</a></li><li><a href=/r/notes/griffiths/ch4-2/>(4.2) The Field of a Polarized Object</a></li><li><a href=/r/notes/griffiths/ch4-3/>(4.3) The Electric Displacement</a></li><li><a href=/r/notes/griffiths/ch4-4/>(4.4) The Linear Dielectrics</a></li><li><a href=/r/notes/griffiths/ch5-1/>(5.1) The Lorentz Force Law</a></li><li><a href=/r/notes/griffiths/ch5-2/>(5.2) The Biot-Savart Law</a></li><li><a href=/r/notes/griffiths/ch5-3/>(5.3) The Divergence and Curl of B</a></li><li><a href=/r/notes/griffiths/ch5-4/>(5.4) Magnetic Vector Potential</a></li><li><a href=/r/notes/griffiths/ch6-1/>(6.1) Magnetization</a></li><li><a href=/r/notes/griffiths/ch6-2/>(6.2) The Field of a Magnetized Object</a></li><li><a href=/r/notes/griffiths/ch6-3/>(6.3) The Auxiliary Field H</a></li><li><a href=/r/notes/griffiths/ch6-4/>(6.4) Linear and Nonlinear Media</a></li><li><a href=/r/notes/griffiths/ch7-1/>(7.1) Electromotive Force</a></li><li><a href=/r/notes/griffiths/ch7-2/>(7.2) Electromagnetic Induction</a></li><li><a href=/r/notes/griffiths/ch7-3/>(7.3) Maxwell's Equations</a></li><li><a href=/r/notes/griffiths/ch8-0/>(8.0) Phys 544 Introduction</a></li><li><a href=/r/notes/griffiths/ch8-1/>(8.1) Charge and Energy</a></li><li><a href=/r/notes/griffiths/ch8-2/>(8.2) Momentum</a></li><li><a href=/r/notes/griffiths/ch9-1/>(9.1) Electromagnetic Waves in One Dimension</a></li><li><a href=/r/notes/griffiths/ch9-2/>(9.2) Wave Equation for E and B</a></li><li><a href=/r/notes/griffiths/ch9-3/>(9.3) Electromagnetic Waves in Matter</a></li><li><a href=/r/notes/griffiths/ch9-4/>(9.4) Electromagnetic Waves in Conductors</a></li><li><a href=/r/notes/griffiths/ch9-5/>(9.5) Guided Waves</a></li><li><a href=/r/notes/griffiths/ch10-1/>(10.1) Scalar and Vector Potentials</a></li><li><a href=/r/notes/griffiths/ch10-2/>(10.2) Retarded Potentials</a></li><li><a href=/r/notes/griffiths/ch10-3/>(10.3) Point Charges</a></li><li><a href=/r/notes/griffiths/ch11-1/>(11.1) Dipole Radiation</a></li><li><a href=/r/notes/griffiths/problems-ch3/>Solved Problems Ch3</a></li><li><a href=/r/notes/griffiths/problems-ch5/>Solved Problems Ch5</a></li><li><a href=/r/notes/griffiths/problems-ch7/>Solved Problems Ch7</a></li><li><a href=/r/notes/griffiths/problems-ch9/>Solved Problems Ch9</a></li></ul></li></ul></li></ul><ul class=book-menu-hugo><li><a href=https://github.com/Peppyhare/r target=_blank rel=noopener>Github</a></li><li><a href=https://themes.gohugo.io/hugo-book/ target=_blank rel=noopener>Hugo Themes</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class="book-header hidden"><div class="flex align-center justify-between"><label for=menu-control><img src=/r/icons/menu.svg class=book-icon alt=Menu></label><h3>MHD Equilibrium Calculations</h3><label for=toc-control><img src=/r/icons/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class=hidden><nav id=TableOfContents><ul><li><a href=#mhd-equilibrium-calculations>MHD Equilibrium Calculations</a></li><li><a href=#linear-stability>Linear Stability</a><ul><li><ul><li><a href=#example-spheromak-tilt-m1>Example: Spheromak Tilt m=1</a></li></ul></li><li><a href=#normalization>Normalization</a></li><li><a href=#initial-conditions>Initial Conditions</a></li><li><a href=#boundary-conditions-for-stability-analysis>Boundary Conditions for Stability Analysis</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=mhd-equilibrium-calculations>MHD Equilibrium Calculations<a class=anchor href=#mhd-equilibrium-calculations>#</a></h1><p>From physical expectations, elliptic equations result from equilibrium calculations and eigenvalue systems. In general, we can write elliptic equations as
<link rel=stylesheet href=/r/katex/katex.min.css><script defer src=/r/katex/katex.min.js></script><script defer src=/r/katex/auto-render.min.js onload=loadKatex()></script><script>function loadKatex(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}],throwOnError:!1,trust:e=>["\\htmlId","\\href"].includes(e.command),macros:{"\\lcm":"\\mathop{\\mathrm{lcm}}","\\sen":"\\text{sen}\\,","\\dd":"\\mathop{\\mathrm{d} #1}","\\abs":"\\lvert #1 \\rvert","\\dd":"\\text{d}","\\cross":"\\times","\\pdv":"\\frac{\\partial #1}{\\partial #2}","\\curl":`\\nabla \\cross #1`,"\\vu":"\\mathbf{\\hat{#1}}","\\vdot":"\\dot","\\div":`\\nabla \\cdot #1`,"\\grad":`\\nabla`,"\\dv":"\\frac{d\\,#1}{d\\,#2}","\\gr":"\\gamma","\\vec":"\\mathbf{#1}","\\tagl":"\\tag{#1}","\\eqref":"(#1)","\\laplacian":`\\mathbf{\\nabla ^2}`,"\\label":"{}","\\negadelta":`\\nabla`,"\\eqref":"\\href{###1}{(\\text{#1})}","\\ref":"\\href{###1}{\\text{#1}}","\\label":"\\htmlId{#1}{}"}})}</script><span>\[\vec A \vec x = \vec b\]
</span>where \( \vec A \) may be a nonlinear function of \( \vec x \). For example, if we think of Poisson&rsquo;s equation in 1D,
<span>\[\dv{^2 \phi}{x^2} = - \rho_c\]
</span>and apply finite differencing,
<span>\[\frac{\phi_{j+1} - 2 \phi_j + \phi_{j-1}}{\Delta x^2} = - \rho_j\]
</span>we get a matrix system
<span>\[\vec A \vec x = \frac{1}{\Delta x^2} \begin{bmatrix} -2 & 1 & 0 & \ldots \\ 1 & -2 & 1 & \ldots \\ \ldots & \ldots & \ldots & \ldots \end{bmatrix} \begin{bmatrix} \phi_1 \\ \phi_2 \\ \ldots \end{bmatrix} = \vec b = - \begin{bmatrix} \rho_1 \\ \rho_2 \\ \ldots \end{bmatrix}\]
</span>where \( \vec A \) is a J by J matrix. In equilibrium calculations, this comes up when solving the Grad-Shafranov equation</p><p><span>\[\Delta ^\star \psi = I I' - \mu_0 r^2 p'\]
</span>where
<span>\[I' = \pdv{I}{\psi} \qquad p' = \pdv{p}{\psi}\]
</span>and
<span>\[\Delta ^\star \equiv r \pdv{}{r} \frac{1}{r} \pdv{}{r} + \pdv{^2}{z^2}\]</span></p><p>The Grad-Shafranov equation is a nonlinear equation, and we often assume a power series expansion of the current density and pressure
<span>\[I(\psi) = I_0 + I_1 \psi + I_2 \psi^2 + \ldots\]
</span><span>\[p(\psi) = p_0 + p_1 \psi + p_2 \psi^2 + \ldots\]</span></p><p>For a force-free equilibrium (\( p = 0 \)) with a linear current profile
<span>\[I I' = I_0 I_1 + I_1 ^2 \psi\]</span></p><p>this makes the Grad-Shafranov equation a linear system.
<span>\[\vec A = \Delta ^\star _{\text{FD}} + I_1 ^2\]
</span><span>\[\vec x = \psi_{ij} \qquad \vec b = (I_0 I_1) _{ij}\]
</span>where \( \Delta ^\star _{\text{FD}} \) is a finite difference representation of the \( \Delta ^\star \) operator. For a given geometry and poloidal current profile, \( I_0 \) and \( I_1 \), we can solve \( \vec A \vec x = \vec b \) to give \( \psi(r, z) \).</p><p>Solving \( \vec A \vec x = \vec b \) can be done using either direct or indirect (iterative) methods. Direct decomposition methods (like Kramer&rsquo;s rule, Gaussian decomposition) require \( \mathcal{O}(N^3) \) operations, where \( N \) is the size of the matrix. They also require full matrix storage, even though \( \vec A \) is a sparse (tridiagonal) matrix.</p><p>Iterative methods help solve this problem. We begin with a solution which is improved upon until we get convergence. If this converges in fewer operations than a full decomposition, then we&rsquo;ve saved some time and a lot of in-memory storage space.</p><p><span>\[x^0 \rightarrow x^1 \rightarrow x^2 \rightarrow \ldots\]
</span><span>\[\vec x^{n+1} = \vec x^n + \vec B^{-1} (\vec b - \vec A \vec x^n) \\
= \vec x^n + \vec B^{-1} \vec r^n\]</span></p><p>The technique boils down to a clever choice of \( \vec B \). We want to choose an approximation matrix \( \vec B \) which is very close to \( \vec A \), but is much easier to invert.
<span>\[\vec B \approx \vec A\]
</span>For this kind of iterative method, each iteration requires \( \mathcal{O}(N) \) operations, and converges in fewer than \( N \) iterations. The best iterative methods can converge in \( \mathcal{O}(N \ln N) \) total operations.</p><h1 id=linear-stability>Linear Stability<a class=anchor href=#linear-stability>#</a></h1><p>When we studied plasma waves at the beginning of this course, we performed a linearization of the Vlasov equation about an equilibrium state. This is how we got dispersion relations for waves. We assumed an equilibrium of a uniform plasma, with at most static magnetic fields. For more interesting equilibria with nonzero gradients, we follow the same procedure.</p><p>First, we linearize the ideal MHD equations about a static equilibrium (\( \vec v_0 = 0 \))
<span>\[\pdv{\rho_1}{t} = - \div (\rho_0 \vec v_1)\]
</span><span>\[\pdv{p_1}{t} = - \div (p_0 \vec v_1) + (1 - \Gamma) p_0 \div \vec v_1\]
</span><span>\[\pdv{\vec B_1}{t} = \curl (\vec v_1 \cross \vec B_0)\]
</span><span>\[\rho _0 \pdv{\vec v_1}{t} = \grad p_1 + \frac{1}{\mu_0} \left[(\curl \vec B_1) \cross \vec B_0 + (\curl \vec B_0) \cross \vec B_1 \right]\]</span></p><p>Given an equilibrium (\( \rho_0 \), \( p_0 \), \( \vec B_0 \)), the linearized MHD equations can be integrated in time to evolve \( \rho_1 \), \( p_1 \), \( \vec B_1 \), \( \vec v_1 \). If we do this and \( \vec v_1 \) grows in time, then the plasma is unstable.</p><p>Notice that \( \rho_1 \) decouples from the other equations, so we don&rsquo;t need to evolve it if we don&rsquo;t want to, or we can evolve it in parallel.</p><p>It&rsquo;s often more useful to study individual modes. We can assume a form of the perturbation to select specific modes. For arbitrary perturbed quantity \( g_1 \),</p><span>\[g_1(\vec r, t) = g_1(r, \theta, z, t) = \hat g_1 (r, z, t) e^{i m \theta}\]</span><p>where \( m \) is the azimuthal mode number. As we&rsquo;ve written it, \( g_1 \) is complex-valued, but only because \( e^{i m \theta} \) is a convenient representation of a Fourier mode. We&rsquo;re only interested in the real component.</p><p><span>\[\text{Re}(g_1) \leftrightarrow g_1(\theta = 0)\]
</span><span>\[\text{Im}(g_1) \leftrightarrow g_1(\theta = - m \pi / 2)\]</span></p><h3 id=example-spheromak-tilt-m1>Example: Spheromak Tilt m=1<a class=anchor href=#example-spheromak-tilt-m1>#</a></h3><p>As an example, we consider the \( m=1 \) tilt mode in the spheromak, a device which consists of a toroidal equilibrium contained in a cylindrical can. The tilt mode, corresponding to \( m=1 \), rotates the equilibrium in the \( r-z \) plane. The elongation ratio \( L/R \) determines the configuration&rsquo;s stability against the tilt mode.</p><p>(stable: L/R=1, unstable: L/R=2)</p><p align=center><img alt=45.png src=/r/img/545/45.png></p><p>Plotting the real part of \( g \) in the \( r-z \) plane at \( \theta = 0 \) looks something like this:</p><p align=center><img alt=46.png src=/r/img/545/46.png></p><p>We can fill out the lower half of the plane at &ldquo;\( r &lt; 0 \)&rdquo; by setting \( \theta = \pi \), so we get the negative of the upper half</p><p align=center><img alt=47.png src=/r/img/545/47.png></p><p>To align the \( r \) axes, we need to flip this upside-down before we can put it on the same axes as the upper \( r-z \) plane.</p><p>The assumed form is implemented in the linear equations. Noting:</p><span>\[\pdv{}{\theta} g_1 = i m \vu g_1 (r, z, t) e^{i m \theta} \\
= i m g_1\]</span><p>The remaining terms are approximated with finite differences.</p><span>\[{\rho_1} _{i, j} ^{n + 1} = {\rho_1}_{i, j} ^n - \left[ \frac{\Delta t (r \rho_0 v_{1, r}) ^n _{i + 1, j} - (r \rho_0 v_{1, r})^n _{i - 1, j} }{2 r_i \Delta r} \right. \\
\left. \qquad + \frac{im}{r_i} (\rho_0 v_{1, \theta})^n _{i, j} + \frac{(\rho_0 v_{1, z})^n _{i, j + 1} - (\rho_0 v_{1, z})^n _{i, j-1}}{2 \Delta z} \right]\]</span><p>We can construct the other difference relations for the other perturbed quantities from the linearized ideal MHD equations:</p><p><span>\[{p_1}_{ij} ^{n+1} = {p_1}_{ij} ^n + \Delta t \left[ \ldots \right]^n\]
</span><span>\[{\vec B_1}_{ij} ^{n+1} = {\vec{B_1}}_{ij} ^n + \Delta t [ \ldots ] ^n\]
</span><span>\[{\vec v_1} _{ij} ^{n+1} = {\vec v_1}_{ij} ^{n+1} + \Delta t [\ldots ]^n\]</span></p><h2 id=normalization>Normalization<a class=anchor href=#normalization>#</a></h2><p>We normalize the PDE&rsquo;s by nondimensionalizing. We do this by choosing characteristic values for density, pressure, magnetic field, velocity</p><p><span>\[\rho_0 = \tilde{\rho_0} \rho ^\star \qquad \text{where} \quad \tilde{\rho_0} \in [0, 1] \]
</span><span>\[\rho_1 = \tilde{\rho_1} \rho^\star\]
</span><span>\[p_0 = \tilde{p_0} p^\star\]
</span><span>\[\vec B_0 = \tilde{\vec B} B^\star\]
</span><span>\[\vec v_1 = \tilde{\vec v_1} v^\star \qquad v^\star = L / \tau\]</span></p><p>We can combine into a single PDE by taking the time derivative of the momentum equation, such that the sound speed and Alfven speed fall out:</p><p><span>\[\pdv{ ^2 \tilde{\vec v_1}}{\tilde t ^2} = \frac{\tau ^2}{L^2} \frac{\Gamma p^\star}{\rho ^\star} f_a (\tilde{\rho}_0, \tilde{p}_0, L/R, \tilde{\vec{v}}_1) + \frac{\tau^2}{L^2} \frac{{B^\star} ^2}{\mu_0 \rho^\star} f_b(\tilde{\rho}_0, \tilde{\vec B}_0, L/R, \tilde{\vec v}_1)\]
</span><span>\[\frac{\Gamma p^\star}{\rho ^\star} = v_s ^2 \qquad \frac{{B^\star}^2}{\mu_0 \rho ^\star}\]</span></p><p>here \( f_a \) and \( f_b \) are some appropriate conversion functions.</p><p>In our nondimensionalization, we normalize \( z \) and \( r \) by characteristic lengths \( L \) and \( R \):</p><p><span>\[t = \tilde t \tau\]
</span><span>\[z = \tilde z L\]
</span><span>\[r = \tilde r R = \frac{\tilde r L}{L/R}\]</span></p><h2 id=initial-conditions>Initial Conditions<a class=anchor href=#initial-conditions>#</a></h2><p>To solve for the evolution of a perturbation in time, we need initial conditions. The initial condition is both the equilibrium \( \rho_0, p_0, \vec B_0, \vec v_0 = 0 \) and the perturbation \( \vec v_1 (r, z) \). For stability analysis, we generally want our perturbation to excite all modes (or as many as possible), and avoid single mode perturbations. The dominant mode will grow the fastest, and we&rsquo;ll see it come out of the excitation.</p><p>You don&rsquo;t want to perturb a magnetic field that breaks \( \div \vec B_1 = 0 \). In generall, you can just perturb the velocity \( \vec v_1 (r, z) \), for example like this
<span>\[\text{Re}(\vec v_1) \propto \sin \left( \frac{\pi r}{R} \right) \cos \left( \frac{\pi z}{L} \right)\]
</span>Because we generally don&rsquo;t expect a radial dependence to be a sin function, \( \sin (\pi r / R) \) should excite many modes. We also need to meet the boundary conditions, hence using functions with easy to compute zeroes.</p><p>We the advance the solution in time, and track the evolution of the perturbed kinetic energy</p><span>\[KE_1(t) = \int \frac{1}{2} \rho_0 \vec {v_1} ^2 \dd \vec V\]</span><p>If the equilibrium is unstable, then a dominant mode will grow out of the oscillations with a measurable growth rate \( \gamma \)</p><p align=center><img alt=48.png src=/r/img/545/48.png></p><p>To study the accuracy order and compare with results, we need to perform a convergence study of the growth rate. We do this by performing the simulation with different grid resolutions. If we plot against some kind of normalized grid resolution \( J_0 ^2 / J ^2 \), where \( J \) is the most coarse grid resolution. We expect second-order convergence, so plotting the square of the resolution should give us straight lines moving towards zero.</p><p align=center><img alt=49.png src=/r/img/545/49.png></p><p>The difference between points as we move to higher resolution gives a bound on the error. We may also find solutions that appear to be unstable, but the projected growth rate is zero (or close to it)</p><p align=center><img alt=50.png src=/r/img/545/50.png></p><p>The eigenfunction \( \vec v_1 \) itself contains useful information, since it describes the unstable behavior. In the m=1 spheromak case, it indicates that the spheromak will tilt. There are other modes that shift the configuration. The difference between these can be seen by looking at the eigenfunction itself.</p><p>The advantages of this time integration method are:</p><ul><li>Simple to implement.</li><li>The approach is general to many equilibria.</li></ul><p>Some of the disadvantages are</p><ul><li>Requires a choice of \( \Delta t \) (eigenvalue problem)</li><li>Marginal stability boundaries are difficult to determine exactly.</li></ul><h2 id=boundary-conditions-for-stability-analysis>Boundary Conditions for Stability Analysis<a class=anchor href=#boundary-conditions-for-stability-analysis>#</a></h2><p>For a rigid conducting wall,</p><p><span>\[\pdv{}{t} \vec B_1 \cdot \vu n = 0 \qquad \text{or, usually} \quad \vec B_1 \cdot \vu n = 0\]
</span><span>\[\vec v_1 \cdot \vu n = 0\]</span></p><p>Scalar quantities (\( \rho_1 \), \( p_1 \)) are set to zero at the boundaries.</p><p>There are also axis conditions in cylindrical geometry, where \( r = 0 \). For axis boundaries, we want to assume that all variables are analytic at the axis. That is, there are no singularities, and the solution is differentiable. Then, we want to map from the \( r \)-\( \theta \) plane to an \( x \)-\( y \) plane. The \( z \) direction is a trivial one-to-one mapping. Then, we expand in a power series such that:</p><span>\[\vec A = \begin{cases} A_x & = & A + Bx + cy + \ldots \\
A_y & = & D + Ex + Fy + \ldots \\
A_z & = & G + Hx + Jy + Kx^2 + Ly^2 + \ldots \end{cases}\]</span><p>Ordinarily, you would extend this out to more terms than this, but in this case we happen to already know how many terms we need. Then, map to the cylindrical coordinates:</p><p><span>\[A_r = A_x \cos \theta + A_y \sin \theta \qquad x = r \cos \theta\]
</span><span>\[A_\theta = - A_x \sin \theta + A_y \cos \theta \qquad y = r \sin \theta\]</span></p><p>Substituting in the expanded quantities gives:</p><span>\[\begin{aligned}
A_r & =& \frac{1}{2} ( B + F) r + A \cos \theta + D \sin \theta + \frac{1}{2} (B - F) r \cos (2 \theta) \\
& & + \frac{1}{2} (C + E) r \sin (2 \theta) + \ldots
\end{aligned}\]
</span><span>\[\begin{aligned}
A_\theta &=& \frac{1}{2} (E - C) r + D \cos \theta - A \sin \theta + \frac{1}{2} (C + E) r \cos (2 \theta) \\
& & + \frac{1}{2}(F - B) r \sin (2 \theta) + \ldots
\end{aligned}\]
</span><span>\[\begin{aligned}
A_z & = & H + Hr \cos \theta + J r \sin \theta + K r^2 \cos ^2 \theta \\
& & + L r^2 \sin ^2 \theta + \ldots
\end{aligned}\]</span><p>The solution behavior at the axis \( r \rightarrow 0 \) depends on the \( \theta \) resolution. We assumed \( A \propto e^{i m \theta} \), or</p><span>\[\vec A = \text{Re}\left[ \left(\vec A ^n + i \vec A ^i \right) e^{i m \theta}\right] \\
= \vec A^r \cos (m \theta) - \vec A^i \sin (m \theta)\]</span><p>where \( \vec A ^r \) is the real component of \( \vec A \). If we consider axisymmetric modes, \( m = 0 \), based on this expression we have no \( \theta \) dependence
<span>\[\vec A = \vec A^r\]</span></p><p>We set the appropriate coefficients to match the expansion. If there is no \( \theta \) dependence, each part of our expansion for \( A_r \), \( A_\theta \), \( A_z \) which has a \( \theta \) dependence must vanish:</p><p><span>\[A = D = B - F = C + E = H = J = K = L = 0\]
</span>so
<span>\[B = F \qquad \text{and} \qquad C = - E\]</span></p><p>which gives</p><p><span>\[A_r = Br \]
</span><span>\[A_\theta = Er\]
</span><span>\[A_z = G \]</span></p><p>as \( r \rightarrow 0 \). So the boundary conditions at the axis are:</p><p><span>\[\left.A_r \right|_{\text{axis}} = 0\]
</span><span>\[\left.A_\theta \right|_{\text{axis}} = 0\]</span></p><span>\[\left.A_z \right|_{\text{axis}} = \text{const.}
\rightarrow \qquad \left.\pdv{A_z}{r} \right| _{\text{axis}} = 0\]</span><p>For \( m = 1 \), \( \vec A = \vec A ^r \cos \theta - \vec A^i \sin \theta \)</p><p>gives</p><p><span>\[B + F = B - F = C + E = E - C = G = K = L = 0\]
</span><span>\[B = F = C = E = 0\]
</span>which gives
<span>\[A_r = A \cos \theta + D \sin \theta\]
</span><span>\[A_\theta = D \cos \theta - A \sin \theta\]
</span><span>\[A_z = H r \cos \theta + J r \sin \theta\]</span></p><p>So the boundary conditions are</p><p><span>\[\left. \pdv{A_r}{r} \right|_{\text{axis}} = 0\]
</span><span>\[\left. \pdv{A_\theta}{r} \right|_{\text{axis}} = 0\]
</span><span>\[\left. A_z \right|_{\text{axis}} = 0\]</span></p><p>Note, the real component of the \( r \) component is the \( \theta \) component of the imaginary component
<span>\[A_r ^r = A_\theta ^i\]
</span>and
<span>\[A_\theta ^r = - A_r ^i\]</span></p><p>We can do the same thing for other mode numbers, and arrive at a general correspondence. Scalar variables map in the same way the axial component \( A_z \).</p><p>Questions??</p><p>Setting up the initial conditions:</p><ul><li>what goes in &ldquo;e&rdquo;?</li><li>calculate B_x, B_y from J_z?</li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div></div><div></div></div><div class="flex flex-wrap justify-between"><span><a href=/r/notes/UWAA545/07-finite-difference-models/ class="flex align-center"><img src=/r/icons/backward.svg class=book-icon alt=Backward>
<span>Finite Difference Methods for MHD</span>
</a></span><span><a href=/r/notes/UWAA560/ class="flex align-center"><span>Plasma Diagnostics</span>
<img src=/r/icons/forward.svg class=book-icon alt=Forward></a></span></div><div class=book-comments></div><script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#mhd-equilibrium-calculations>MHD Equilibrium Calculations</a></li><li><a href=#linear-stability>Linear Stability</a><ul><li><ul><li><a href=#example-spheromak-tilt-m1>Example: Spheromak Tilt m=1</a></li></ul></li><li><a href=#normalization>Normalization</a></li><li><a href=#initial-conditions>Initial Conditions</a></li><li><a href=#boundary-conditions-for-stability-analysis>Boundary Conditions for Stability Analysis</a></li></ul></li></ul></nav></div></aside></main></body></html>