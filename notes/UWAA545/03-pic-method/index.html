<!doctype html><html lang=en dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="




  \[\]



  Particle-In-Cell Model (Particle model revisited)
  #

The order of magnitude issues with the N-body model prevent a direct application in even simple laboratory plasmas. In a plasma with \( N = O(10^{21}) \), we have interactions on the order of \( O(10^{42}) \) making direct computation completely impractical."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://peppyhare.github.io/r/notes/UWAA545/03-pic-method/"><meta property="og:site_name" content="My Notes"><meta property="og:title" content="Particle in Cell Model"><meta property="og:description" content="\[\] Particle-In-Cell Model (Particle model revisited) # The order of magnitude issues with the N-body model prevent a direct application in even simple laboratory plasmas. In a plasma with \( N = O(10^{21}) \), we have interactions on the order of \( O(10^{42}) \) making direct computation completely impractical."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="notes"><meta property="article:modified_time" content="2021-04-27T21:59:43-07:00"><title>Particle in Cell Model | My Notes</title>
<link rel=icon href=/r/favicon.png><link rel=manifest href=/r/manifest.json><link rel=canonical href=https://peppyhare.github.io/r/notes/UWAA545/03-pic-method/><link rel=stylesheet href=/r/book.min.a9f8198cc4e08a8c08b25f83e2006e5e66c64d3d34b7046b3e8712b7980c6821.css integrity="sha256-qfgZjMTgiowIsl+D4gBuXmbGTT00twRrPocSt5gMaCE=" crossorigin=anonymous><script defer src=/r/fuse.min.js></script><script defer src=/r/en.search.min.3c4ae99807fd8a5805e4efebc01734f4c60f36cea0b624b9e5b3a2fbe7ab993c.js integrity="sha256-PErpmAf9ilgF5O/rwBc09MYPNs6gtiS55bOi++ermTw=" crossorigin=anonymous></script><script defer src=/r/sw.min.9e3a83f0b071ebe0141a16a33db93faadb2bdf712473a218febeed35ed243c08.js integrity="sha256-njqD8LBx6+AUGhajPbk/qtsr33Ekc6IY/r7tNe0kPAg=" crossorigin=anonymous></script><link rel=preload href=/r/katex/fonts/KaTeX_Main-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Main-Bold.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Main-Italic.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Math-Italic.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Size2-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/katex/fonts/KaTeX_Size3-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/fonts/roboto-v27-latin-regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/r/fonts/roboto-v27-latin-700.woff2 as=font type=font/woff2 crossorigin=anonymous></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/r/><span>My Notes</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/r/svg/translate.svg class=book-icon alt=Languages>
English</a></label><ul></ul></li></ul><ul><li class=book-section-flat><ul><li class=book-section-flat><input type=checkbox id=section-f04c181c9b16a37431fe06303d58b7a0 class=toggle checked>
<label for=section-f04c181c9b16a37431fe06303d58b7a0 class="flex justify-between"><a href=/r/notes/UWAA545/ class="navbutton
book-collapse-section">Computational Methods For Plasmas</a></label><ul><li><a href=/r/notes/UWAA545/01-syllabus/ class=navbutton>Syllabus</a></li><li><a href=/r/notes/UWAA545/02-plasma-models/ class=navbutton>Plasma Models</a></li><li><a href=/r/notes/UWAA545/03-pic-method/ class="active navbutton">Particle in Cell Model</a></li><li><a href=/r/notes/UWAA545/04-pic-example/ class=navbutton>PIC - Example Implementation</a></li><li><a href=/r/notes/UWAA545/05-electrodynamic-pic/ class=navbutton>Multidimensional Electrodynamic PIC</a></li><li><a href=/r/notes/UWAA545/06-fluid-models/ class=navbutton>Fluid Models for Plasmas</a></li><li><a href=/r/notes/UWAA545/07-finite-difference-models/ class=navbutton>Finite Difference Methods for MHD</a></li><li><a href=/r/notes/UWAA545/08-mhd-equilibrium/ class=navbutton>MHD Equilibrium Calculations</a></li><li><a href=/r/notes/UWAA545/formulary/ class=navbutton>Formulary</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-b6bdf3598cf4214623cd2f8ff7b6e0f2 class=toggle>
<label for=section-b6bdf3598cf4214623cd2f8ff7b6e0f2 class="flex justify-between"><a href=/r/notes/UWAA560/ class="navbutton
book-collapse-section">Plasma Diagnostics</a></label><ul><li><a href=/r/notes/UWAA560/01-syllabus/ class=navbutton>Syllabus</a></li><li><a href=/r/notes/UWAA560/02-diagnostic-considerations/ class=navbutton>General Diagnostic Considerations</a></li><li><a href=/r/notes/UWAA560/03-magnetic-field-diagnostics/ class=navbutton>Magnetic Field Diagnostics</a></li><li><a href=/r/notes/UWAA560/04-electrostatic-diagnostics/ class=navbutton>Electrostatic Diagnostics</a></li><li><a href=/r/notes/UWAA560/05-index-of-refraction-measurements/ class=navbutton>Index of Refraction Measurements</a></li><li><a href=/r/notes/UWAA560/06-spectroscopic-measurements/ class=navbutton>Spectroscopic Measurements</a></li><li><a href=/r/notes/UWAA560/90-student-lectures/ class=navbutton>Student Lectures</a></li><li><a href=/r/notes/UWAA560/91-zeeman-spectroscopy/ class=navbutton>My class lecture</a></li><li><a href=/r/notes/UWAA560/formulary/ class=navbutton>Formulary</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-5b051410be8cdb0f46ad32fc2ad5a20d class=toggle>
<label for=section-5b051410be8cdb0f46ad32fc2ad5a20d class="flex justify-between"><a href=/r/notes/UWAA558/ class="navbutton
book-collapse-section">MHD Theory</a></label><ul><li><a href=/r/notes/UWAA558/01-syllabus/ class=navbutton>Syllabus</a></li><li><a href=/r/notes/UWAA558/02-plasma-models/ class=navbutton>Plasma Models</a></li><li><a href=/r/notes/UWAA558/03-plasma-fluid-model/ class=navbutton>Plasma Fluid Model</a></li><li><a href=/r/notes/UWAA558/04-two-fluid-plasma-model/ class=navbutton>Two-Fluid Plasma Model</a></li><li><a href=/r/notes/UWAA558/05-mhd-model/ class=navbutton>Magnetohydrodynamic (MHD) Model</a></li><li><a href=/r/notes/UWAA558/06-boundary-conditions/ class=navbutton>Boundary Conditions</a></li><li><a href=/r/notes/UWAA558/07-equilibrium-for-fusion/ class=navbutton>Equilibrium for Fusion</a></li><li><a href=/r/notes/UWAA558/08-1d-equilibria/ class=navbutton>1-D Equilibria</a></li><li><a href=/r/notes/UWAA558/09-2d-equilibria/ class=navbutton>2D Equilibria</a></li><li><a href=/r/notes/UWAA558/10-equilibrium-of-3d-configurations/ class=navbutton>Equilibrium of 3D Configurations</a></li><li><a href=/r/notes/UWAA558/11-mhd-stability/ class=navbutton>MHD Stability</a></li><li><a href=/r/notes/UWAA558/formulary/ class=navbutton>Formulary</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-c3201a1057283cb12ab09a42fe89bfb2 class=toggle>
<label for=section-c3201a1057283cb12ab09a42fe89bfb2 class="flex justify-between"><a href=/r/notes/research/ class="navbutton
book-collapse-section">Research Notes</a></label><ul><li><a href=/r/notes/research/dgh-datta/ class=navbutton>Electrodynamic Dory-Guest-Harris Instability</a></li><li><a href=/r/notes/research/valgrind/ class=navbutton>Valgrind</a></li><li><a href=/r/notes/research/warpxm-101/ class=navbutton>WARPXM 101 - Getting Started</a></li><li><a href=/r/notes/research/warpxm-102/ class=navbutton>WARPXM 102 - Code Structure</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-34991d35561e8d266d64d5d323e97c7a class=toggle>
<label for=section-34991d35561e8d266d64d5d323e97c7a class="flex justify-between"><a href=/r/notes/UWAA557/ class="navbutton
book-collapse-section">Physics of Fusion Plasmas</a></label><ul><li><a href=/r/notes/UWAA557/ch10-0/ class=navbutton>Rules of thumb</a></li><li><a href=/r/notes/UWAA557/ch10-1/ class=navbutton>Statistical Mechanics</a></li><li><a href=/r/notes/UWAA557/ch10-2/ class=navbutton>Review of E&amp;M</a></li><li><a href=/r/notes/UWAA557/ch10-3/ class=navbutton>Lagrange Multipliers</a></li><li><a href=/r/notes/UWAA557/ch11-1/ class=navbutton>Wall-supported Plasma</a></li><li><a href=/r/notes/UWAA557/ch11-2/ class=navbutton>Collisions</a></li><li><a href=/r/notes/UWAA557/ch11-3/ class=navbutton>Oscillations</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-7c7b4e4d4494a744744faedd969cb670 class=toggle>
<label for=section-7c7b4e4d4494a744744faedd969cb670 class="flex justify-between"><a href=/r/notes/UWAA543/ class="navbutton
book-collapse-section">Computational CFD</a></label><ul><li><a href=/r/notes/UWAA543/ch20-1/ class=navbutton>Introduction to Computational CFD</a></li><li><a href=/r/notes/UWAA543/ch20-2/ class=navbutton>Governing Equations</a></li><li><a href=/r/notes/UWAA543/ch20-3/ class=navbutton>Reduced Models</a></li><li><a href=/r/notes/UWAA543/ch20-4/ class=navbutton>Equation Types</a></li><li><a href=/r/notes/UWAA543/ch20-5/ class=navbutton>Panel Method</a></li><li><a href=/r/notes/UWAA543/ch21-1/ class=navbutton>Finite Difference Algorithms</a></li><li><a href=/r/notes/UWAA543/ch21-2/ class=navbutton>Explicit Finite Difference Algorithms</a></li><li><a href=/r/notes/UWAA543/ch21-3/ class=navbutton>Finite Difference and Finite Volume Methods</a></li><li><a href=/r/notes/UWAA543/ch21-4/ class=navbutton>Implicit Algorithms</a></li><li><a href=/r/notes/UWAA543/ch21-5/ class=navbutton>Numerical Boundary Conditions</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-e5f141895443fc824f58730f7904d483 class=toggle>
<label for=section-e5f141895443fc824f58730f7904d483 class="flex justify-between"><a href=/r/notes/UWAA556/ class="navbutton
book-collapse-section">Plasma Waves</a></label><ul><li><a href=/r/notes/UWAA556/ch01-1/ class=navbutton>Mathematical review</a></li><li><a href=/r/notes/UWAA556/ch02-1/ class=navbutton>Plasma Waves in General Dielectric Media</a></li><li><a href=/r/notes/UWAA556/ch02-2/ class=navbutton>Wave Properties in Cold Unmagnetized Plasma</a></li><li><a href=/r/notes/UWAA556/ch02-3/ class=navbutton>Cold Magnetized Plasma Dispersion Relation</a></li><li><a href=/r/notes/UWAA556/ch02-4/ class=navbutton>The CMA Diagram</a></li><li><a href=/r/notes/UWAA556/ch03-1/ class=navbutton>Introduction to Kinetic Theory</a></li><li><a href=/r/notes/UWAA556/ch03-2/ class=navbutton>Landau Damping</a></li><li><a href=/r/notes/UWAA556/ch03-3/ class=navbutton>Waves in Hot Magnetized Plasma</a></li><li><a href=/r/notes/UWAA556/ch04-1/ class=navbutton>Fluid stuff</a></li><li><a href=/r/notes/UWAA556/ch04-2/ class=navbutton>Quasi-Linear Theory</a></li><li><a href=/r/notes/UWAA556/ch05-1/ class=navbutton>Diffusion and Resistivity</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-3a2759a8b11b3422da800ed19897932a class=toggle>
<label for=section-3a2759a8b11b3422da800ed19897932a class="flex justify-between"><a href=/r/notes/problems/ class="navbutton
book-collapse-section">Worked Problems</a></label><ul><li><a href=/r/notes/problems/gurnett/ch02/ class=navbutton>Characteristic Parameters of a Plasma</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-05ac7760b68f0e0530d0e609833f6902 class=toggle>
<label for=section-05ac7760b68f0e0530d0e609833f6902 class="flex justify-between"><a role=button class="navbutton
book-collapse-section">Scratch</a></label><ul><li><a href=/r/notes/scratch/colors/ class=navbutton>Adding Color</a></li><li><a href=/r/notes/scratch/crews2018/ class=navbutton>Crews (2018)</a></li><li><a href=/r/notes/scratch/datta2021/ class=navbutton>Datta (2021)</a></li><li><a href=/r/notes/scratch/drawing/ class=navbutton>Drawing Diagrams</a></li><li><a href=/r/notes/scratch/goedbloed/ class=navbutton>Goedbloed (2019)</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-c8688d5789736c2ae128963cf705a441 class=toggle>
<label for=section-c8688d5789736c2ae128963cf705a441 class="flex justify-between"><a href=/r/notes/griffiths/ class="navbutton
book-collapse-section">Griffiths Introduction to Electrodynamics</a></label><ul><li><a href=/r/notes/griffiths/ch1-1/ class=navbutton>Vector Algebra</a></li><li><a href=/r/notes/griffiths/ch1-2/ class=navbutton>Differential Calculus</a></li><li><a href=/r/notes/griffiths/ch1-3/ class=navbutton>Integral Calculus</a></li><li><a href=/r/notes/griffiths/ch1-4/ class=navbutton>Curvilinear Coordinates</a></li><li><a href=/r/notes/griffiths/ch1-5/ class=navbutton>The Dirac Delta Function</a></li><li><a href=/r/notes/griffiths/ch1-6/ class=navbutton>The Theory of Vector Fields</a></li><li><a href=/r/notes/griffiths/ch2-1/ class=navbutton>The Electric Field</a></li><li><a href=/r/notes/griffiths/ch2-2/ class=navbutton>Divergence and Curl of Electrostatic Fields</a></li><li><a href=/r/notes/griffiths/ch2-3/ class=navbutton>Electric Potential</a></li><li><a href=/r/notes/griffiths/ch2-4/ class=navbutton>Work and Energy in Electrostatics</a></li><li><a href=/r/notes/griffiths/ch2-5/ class=navbutton>Conductors</a></li><li><a href=/r/notes/griffiths/ch3-1/ class=navbutton>Laplace's Equation</a></li><li><a href=/r/notes/griffiths/ch3-2/ class=navbutton>The Method of Images</a></li><li><a href=/r/notes/griffiths/ch3-3/ class=navbutton>Separation of Variables</a></li><li><a href=/r/notes/griffiths/ch3-4/ class=navbutton>Multipole Expansion</a></li><li><a href=/r/notes/griffiths/ch4-1/ class=navbutton>Polarization</a></li><li><a href=/r/notes/griffiths/ch4-2/ class=navbutton>The Field of a Polarized Object</a></li><li><a href=/r/notes/griffiths/ch4-3/ class=navbutton>The Electric Displacement</a></li><li><a href=/r/notes/griffiths/ch4-4/ class=navbutton>The Linear Dielectrics</a></li><li><a href=/r/notes/griffiths/ch5-1/ class=navbutton>The Lorentz Force Law</a></li><li><a href=/r/notes/griffiths/ch5-2/ class=navbutton>The Biot-Savart Law</a></li><li><a href=/r/notes/griffiths/ch5-3/ class=navbutton>The Divergence and Curl of B</a></li><li><a href=/r/notes/griffiths/ch5-4/ class=navbutton>Magnetic Vector Potential</a></li><li><a href=/r/notes/griffiths/ch6-1/ class=navbutton>Magnetization</a></li><li><a href=/r/notes/griffiths/ch6-2/ class=navbutton>The Field of a Magnetized Object</a></li><li><a href=/r/notes/griffiths/ch6-3/ class=navbutton>The Auxiliary Field H</a></li><li><a href=/r/notes/griffiths/ch6-4/ class=navbutton>Linear and Nonlinear Media</a></li><li><a href=/r/notes/griffiths/ch7-1/ class=navbutton>Electromotive Force</a></li><li><a href=/r/notes/griffiths/ch7-2/ class=navbutton>Electromagnetic Induction</a></li><li><a href=/r/notes/griffiths/ch7-3/ class=navbutton>Maxwell's Equations</a></li><li><a href=/r/notes/griffiths/ch8-0/ class=navbutton>Phys 544 Introduction</a></li><li><a href=/r/notes/griffiths/ch8-1/ class=navbutton>Charge and Energy</a></li><li><a href=/r/notes/griffiths/ch8-2/ class=navbutton>Momentum</a></li><li><a href=/r/notes/griffiths/ch9-1/ class=navbutton>Electromagnetic Waves in One Dimension</a></li><li><a href=/r/notes/griffiths/ch9-2/ class=navbutton>Wave Equation for E and B</a></li><li><a href=/r/notes/griffiths/ch9-3/ class=navbutton>Electromagnetic Waves in Matter</a></li><li><a href=/r/notes/griffiths/ch9-4/ class=navbutton>Electromagnetic Waves in Conductors</a></li><li><a href=/r/notes/griffiths/ch9-5/ class=navbutton>Guided Waves</a></li><li><a href=/r/notes/griffiths/ch10-1/ class=navbutton>Scalar and Vector Potentials</a></li><li><a href=/r/notes/griffiths/ch10-2/ class=navbutton>Retarded Potentials</a></li><li><a href=/r/notes/griffiths/ch10-3/ class=navbutton>Point Charges</a></li><li><a href=/r/notes/griffiths/ch11-1/ class=navbutton>Dipole Radiation</a></li><li><a href=/r/notes/griffiths/problems-ch3/ class=navbutton>Solved Problems Ch3</a></li><li><a href=/r/notes/griffiths/problems-ch5/ class=navbutton>Solved Problems Ch5</a></li><li><a href=/r/notes/griffiths/problems-ch7/ class=navbutton>Solved Problems Ch7</a></li><li><a href=/r/notes/griffiths/problems-ch9/ class=navbutton>Solved Problems Ch9</a></li></ul></li></ul></li></ul><ul class=book-menu-hugo><li><a href=https://github.com/Peppyhare/r target=_blank rel=noopener>Github</a></li><li><a href=https://themes.gohugo.io/hugo-book/ target=_blank rel=noopener>Hugo Themes</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/r/svg/menu.svg class=book-icon alt=Menu></label><h3>Particle in Cell Model</h3><label for=toc-control><img src=/r/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#particle-in-cell-model-particle-model-revisited>Particle-In-Cell Model (Particle model revisited)</a><ul><li><ul><li><a href=#relationship-to-n-body-and-kinetic-models>Relationship to N-Body and Kinetic Models</a></li></ul></li><li><a href=#general-comments-on-kinetic-models>General Comments on Kinetic Models</a></li><li><a href=#computational-methods-for-pic>Computational Methods for PIC</a></li><li><a href=#particle--force-weighting>Particle & Force Weighting</a></li><li><a href=#particle-push>Particle Push</a></li><li><a href=#electromagnetic-field-solver>Electromagnetic Field Solver</a><ul><li><a href=#periodic-domains---fourier-series-expansion>Periodic Domains - Fourier Series Expansion</a></li></ul></li><li><a href=#full-electrostatic-pic-algorithm>Full Electrostatic PIC Algorithm</a></li><li><a href=#magnetostatic-pic>Magnetostatic PIC</a></li><li><a href=#electrodynamic-pic>Electrodynamic PIC</a><ul><li><a href=#current-weighting>Current Weighting</a></li><li><a href=#longitudinal-electric-field>Longitudinal Electric Field</a></li><li><a href=#electrodynamic-pic-algorithm>Electrodynamic PIC algorithm</a></li></ul></li><li><a href=#application-of-pic---two-stream-instability>Application of PIC - Two Stream Instability</a><ul><li><a href=#dispersion-relation>Dispersion Relation</a></li></ul></li><li><a href=#boundary-conditions-for-finite-systems>Boundary Conditions for Finite Systems</a><ul><li><a href=#implementation---reflected-particles>Implementation - Reflected Particles</a></li><li><a href=#implementation---absorbedemitted-particles>Implementation - Absorbed/Emitted particles</a></li><li><a href=#implementation---open-boundaries>Implementation - Open Boundaries</a></li></ul></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><link rel=stylesheet href=/r/katex/katex.min.css><script defer src=/r/katex/katex.min.js></script><script defer src=/r/katex/auto-render.min.js onload=loadKatex()></script><script>function loadKatex(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}],throwOnError:!1,trust:e=>["\\htmlId","\\href"].includes(e.command),macros:{"\\lcm":"\\mathop{\\mathrm{lcm}}","\\sen":"\\text{sen}\\,","\\dd":"\\mathop{\\mathrm{d} #1}","\\abs":"\\lvert #1 \\rvert","\\dd":"\\text{d}","\\cross":"\\times","\\pdv":"\\frac{\\partial #1}{\\partial #2}","\\curl":`\\nabla \\cross #1`,"\\vu":"\\mathbf{\\hat{#1}}","\\vdot":"\\dot","\\div":`\\nabla \\cdot #1`,"\\grad":`\\nabla`,"\\dv":"\\frac{d\\,#1}{d\\,#2}","\\gr":"\\gamma","\\vec":"\\mathbf{#1}","\\tagl":"\\tag{#1}","\\eqref":"(#1)","\\laplacian":`\\mathbf{\\nabla ^2}`,"\\label":"{}","\\negadelta":`\\nabla`,"\\eqref":"\\href{###1}{(\\text{#1})}","\\ref":"\\href{###1}{\\text{#1}}","\\label":"\\htmlId{#1}{}"}})}</script><span>\[\]</span><h1 id=particle-in-cell-model-particle-model-revisited>Particle-In-Cell Model (Particle model revisited)
<a class=anchor href=#particle-in-cell-model-particle-model-revisited>#</a></h1><p>The order of magnitude issues with the N-body model prevent a direct application in even simple laboratory plasmas. In a plasma with \( N = O(10^{21}) \), we have interactions on the order of \( O(10^{42}) \) making direct computation completely impractical.</p><p>We can instead use representative particles with the same charge to mass ratio, but fewer (\( N = 10^3 \sim 10^7 \)) particles. The governing equations for such a model look very similar to the N-body model:</p><p><span>\[\dv{\vec v_i}{t} = \left( \frac{q}{m} \right)_i (\vec E + \vec v_i \cross \vec B) + \sum_{j \neq i} \left. \dv{\vec v_{ij}}{t} \right|_{coll} \delta (\vec r_i - \vec r_j)\]
</span><span>\[\dv{\vec r_i}{t} = \vec v_i\]</span></p><p>These hold for each superparticle \( i \). We can track the position and velocity in time \( (\vec r, \vec v)_i \) of each superparticle \( i \). The physical properties of superparticle \( i \) will be:</p><span>\[m_i = m_\alpha \frac{N_{plasma}}{N_{model}} \qquad \alpha = \text{ion, electron, ...}\]
</span><span>\[q_i = q_\alpha \frac{N_{plasma}}{N_{model}}\]
</span><span>\[n_i = n_\alpha \frac{N_{model}}{N_{plasma}}\]</span><p>Since \( q_i / m_i = q_\alpha / m_\alpha \), the collisionless dynamics will be preserved for the same \( \vec E \) and \( \vec B \). Provided a sufficiently large number of superparticles (adequate statistics), this means we can use this heavily reduced model to capture the entire behavior of the plasma.</p><p>Let&rsquo;s compute some plasma parameters for this &ldquo;undersampled&rdquo; system.</p><span>\[\omega_p = \sqrt{\frac{n_\alpha q_\alpha ^2}{\epsilon_0 m_\alpha}} = \sqrt{\frac{n_i q_i ^2}{\epsilon_0 m_i}}\]</span><p>We find that the plasma frequency remains the same for the sampled system. The cyclotron frequency is also preserved for the physical system.</p><span>\[\omega_c = \frac{q_\alpha B}{m_\alpha} = \frac{q_i B}{m_i}\]</span><p>However, if we look at the Debye length, we see that it changes</p><span>\[\lambda_D = \frac{v_{th}}{\omega_p} = \sqrt{\frac{\epsilon_0 k T_\alpha}{n_\alpha q_\alpha ^2}} = {\sqrt{\frac{\epsilon_0 k T_i}{n_i q_i ^2}}} \sqrt{\frac{N_{model}}{N_{plasma}}}\]</span><p>This difference will have important implications on the spatial scales and resolution of the model. The coupling to the Maxwell&rsquo;s equations is accomplished as we did in the N-body model.</p><p>There are two outstanding issues that we need to address before we can move on to computation:</p><ul><li>Singularities. The Coulomb force between two charged particles approaches \( \infty \) as \( r \rightarrow 0 \).</li><li>Large number of interactions. Even with fewer particles, \( O(10^7) \), there are still \( N^2 \) particle-particle interactions at all times. \( O(10^{14}) \) interactions is still not really practical to compute.</li></ul><p>To deal with singularities, we can use finite-size particles, with their properties diffusely distributed throughout their volume. When these particle &ldquo;clouds&rdquo; begin to overlap, the overlapping volumes cancel each other, and when the particles overlap entirely (\( r = 0 \)), the force is zero</p><p align=center><img alt=3.png src=/r/img/545/3.png></p><p>The same technique is used in hydrodynamics in a model called SPH (smooth particle hydrodynamics). SPH techniques are used quite often for hypervelocity impacts, like asteroids striking a planet. An interesting application of SPH is the brasil nut problem: why do brasil nuts end up at the top of a can of mixed nuts? As it turns out, if we model simple normal collisions in a can of particles of varying sizes, we don&rsquo;t see the effect at all. However, if we introduce friction between particles then the effect does show up, so we can deduce that the surface area to volume ratio of the brasil nut is important.</p><p>Using SPH in a plasma is more complicated, because plasma particles interact with every other particle through long range EM forces. We can no longer limit interactions locally in a plasma. Instead, to limit the number of interactions, we use a spatial grid to integrate the EM forces. Electromagnetic sources from each particle \( i \) are assigned to a spatial grid node \( j \)</p><p align=center><img alt=4.png src=/r/img/545/4.png></p><p>Then, \( \vec E \) and \( \vec B \) are computed on the grid based on \( \rho_j \) and \( \vec j _j \) to give \( (\vec E, \vec B)_j \). Then, particle positions and velocities are evolved using \( (\vec E, \vec B)_j \) to compute local forces on each particle.</p><p>The computational time required to compute the fields depends on the number of grid points, \( M \). At each time step, this requires \( O(M^2) \) operations. The computational time required to compute assign particles positions and velocities to the grid and compute forces on each particle is \( O(N) \). This makes the total compute time \( O(M^2 + \alpha N) \ll N^2 \)</p><h3 id=relationship-to-n-body-and-kinetic-models>Relationship to N-Body and Kinetic Models
<a class=anchor href=#relationship-to-n-body-and-kinetic-models>#</a></h3><p>PIC is similar to the N-body model in some obvious ways:</p><ul><li>The plasma is treated as discrete particles that interact through EM fields</li><li>Same governing equations, only with fewer particles</li></ul><p>However, the EM fields are computed by currents and charges localized to a spatial grid. This is an important distinction. It is what removes the n-body interactions from the model.</p><p>By comparison to the kinetic model, kinetic models are derived by performing an ensemble average to transform from discrete space to a smooth, continuous space. The averaging process accounts for smoothly varying long-range forces, which is just what we&rsquo;ve done by mapping our particles to a spatial grid. The short-range abrupt forces are encompassed in the collision operator in the same way. The same idea of separating the smooth long-range forces from the abrupt forces was the key Vlasov insight. As we arbitrarily crank up the spatial resolution, the PIC model converges not to the N-body model, but to the Vlasov kinetic model.</p><p>PIC models are &ldquo;particle ensemble averages,&rdquo; but not in a strict sense. They can be thought of as a sampling or discretization of the continuous phase space.</p><h2 id=general-comments-on-kinetic-models>General Comments on Kinetic Models
<a class=anchor href=#general-comments-on-kinetic-models>#</a></h2><ul><li>The PIC method is a robust and efficient method for collisionless plasmas. Collisions are usually modeled using Monte Carlo methods.</li><li>PIC does not work well when the physics is dominated by a small population (small number of particles), because the sampling error becomes very significant.</li><li>PIC methods work well for handling vacuum boundaries, but physical boundaries are more difficult. This is the opposite of the case for fluid models.</li><li>PIC methods naturally resolve sharp features in phase space, e.g. a cold beam</li><li>Continuum kinetic methods can require more computational effort. PIC methods have been around since the 60&rsquo;s, but continuum models have only become computationally practical more recently. There are a couple of reasons for this. Dimensionality is a key component. Continuum distribution methods encompass a six-dimensional space, but particle methods can work in three-dimensional spaces. Additionally, solving the governing equations Boltzmann, Vlasov, Vlasov + Fokker-Planck, etc. are more complicated than the equation of motion for the PIC method.</li><li>Continuum methods better model tails of distributions, which is often where interesting physics happens. E.g ionization, fusion are driven by the high energy tail of the distribution, while the overall dynamics are determined by the bulk. If tails are not interesting, then computational effort is wasted on large unoccupied regions of phase space. Tails also constrain the numerical solution for continuum methods. High velocity and low density can lead to oscillations where the value of the distribution function is very small, leading to potentially negative values.</li><li>Continuum methods (more generally fluid methods) can introduce numerical diffusion and dispersion.<ul><li>Diffusion leads to a smoothing of sharp features over time.</li><li>Dispersion leads to low/high wavenumber features propagating at the wrong speed.</li></ul></li></ul><h2 id=computational-methods-for-pic>Computational Methods for PIC
<a class=anchor href=#computational-methods-for-pic>#</a></h2><ul><li>PIC can easily be extended to include relativistic effects, only requiring minimal changes to the equation of motion.</li><li>Collisions are often neglected in PIC methods, assuming a low density, collisionless plasma. As we try to apply PIC methods to collisional plasmas, the accuracy gets worse.</li></ul><p>Let&rsquo;s talk about how we go about solving the governing equations for a plasma. First, we divide the domain into a <em>uniform</em> grid, \( \Delta x = \Delta y = \Delta z = const. \). We will have a distribution of particles throughout the domain with independent position and velocity \( (\vec x, \vec v)_i \).</p><p align=center><img alt=5.png src=/r/img/545/5.png></p><p>The geometry of the particles themselves depends on dimensionality.</p><ul><li>Particles have an infinite extent in unresolved dimensions. In 3D, this means that particles are spheres. In 2D they are cylindrical, and in 1D they are planar.</li></ul><p>The general procedure for solving the PIC method goes like this:</p><ol><li>Particles are weighted to the grid. The position of each particle \( i \) in phase space \( (\vec x, \vec v)_i \) is weighted to the grid to compute the electromagnetic source terms \( (\rho_c, \vec j)_j \) at each grid location \( j \).
<span>\[\underbrace{(\vec x, \vec v)_i}_{\text{particles}} \rightarrow \underbrace{(\rho_c, \vec j)_j}_{\text{grid}} \qquad \text{(Particle weighting)}\]</span></li><li>Advance the electric and magnetic fields on the grid
<span>\[\underbrace{(\rho_c, \vec j)_j}_{\text{grid}} \rightarrow \underbrace{(\vec E, \vec B)_j}_{\text{grid}} \qquad \text{(Field solve)}\]</span></li><li>Electromagnetic fields are weighted to particles
<span>\[\underbrace{(\vec E, \vec B)_j}_{\text{grid}} \rightarrow \underbrace{\vec F_i}_{\text{particle}} \qquad \text{(Force weighting)}\]</span></li><li>Particles are advanced in time
<span>\[\vec F_i \rightarrow \vec v_i \rightarrow \vec x_i\]</span></li></ol><h2 id=particle--force-weighting>Particle & Force Weighting
<a class=anchor href=#particle--force-weighting>#</a></h2><p>As mentioned earlier, PIC uses finite size particles rather than point particles to avoid the issue of force singularities. This is particularly important in the 1-dimensional case, since infinitesimal particles would never be able to exchange positions. <em>The exact size and shape of the particles matter</em>. The charge density for a point particle is</p><span>\[\rho_c(\vec r) = q_i \delta (\vec r - \vec r_i)\]</span><p>For a finite-size particle,</p><span>\[\rho_c (\vec r) = q_i S(\vec r - \vec r_i)\]</span><p>where \( S \) is a particle shape factor. Conservation of charge requires
<span>\[\int S(\vec r - \vec r_i) \dd \vec r = \int \delta ( \vec r - \vec r _i) \dd \vec r = 1\]</span></p><p>The Lorentz force must be weighted to the particles using the same shape factor in order to get consistent dynamics. For \( \vec B = 0 \),
<span>\[\vec F_i = q_i \vec E (\vec r_i) = \overbrace{q_i \int \vec E(\vec r) \delta (\vec r - \vec r_i) \dd \vec r}^{\text{point particles}} \\
= \underbrace{q_i \int \vec E(\vec r) S(\vec r - \vec r_i) \dd \vec r}_{\text{finite-size particles}}\]</span></p><p>Particles must have local support, meaning \( S(\vec r - \vec r_i) \) is spatially restricted to a small portion of the grid. The simplest weighting/shape is a uniform charge cloud. In 1D, this is</p><span>\[S(x) = \begin{cases} 1/a_0 &\qquad & \text{if} \quad |x| \leq a_0 /2 \\
0 &\qquad & \text{otherwise}
\end{cases}\]</span><p>This provides zeroth-order weighting to the nearest grid point (NGP). When we go to compute the fields from our source terms, the particle will only contribute to the closest single grid point.</p><p>If the size of our particle is very small compared to the grid spacing \( \Delta x > a_0 \), what happens to \( \rho_c \) as the particle drifts through the grid? Because we compute the weighted density as \( \rho_c (\vec r) = q_i S(\vec r - \vec r_i) \), there will be some positions for which a particle will not contribute to any grid point. Likewise, if \( \Delta x &lt; a_0> \), then the particle appears on multiple grid points, but only at some times, producing double-counting. Both of these cases violate conservation of charge:</p><span>\[\pdv{}{t} \int q_\alpha f_\alpha \dd \vec x \dd \vec v = 0\]</span><p>To conserve charge, <strong>\( \Delta x \) must equal \( a_0 \)</strong>. This is a limitation of zeroth-order weighting.</p><p>Even if we have \( \Delta x = a_0 \), nearest grid point still produced particles that appear and disappear on the grid instantaneously, but at least they appear/disappear in a way that conserves total charge. The resulting charge distribution is noisy as a result, hinting at a general issue with PIC methods. The noise introduced by weighting charge distribution to a grid is addressed by using many particles, \( N \gg M \). Typically, we&rsquo;ll use \( N \sim M^2 \).</p><p>The nearest grid point weighting can be improved to 1st order, using a linear \( S(x) \).</p><p align=center><img alt=6.png src=/r/img/545/6.png></p><p>We maintain the important property \( \int S(x) \dd x = 1 \). Using \( a_0 = \Delta x \) so that</p><span>\[\sum_j S(x_j - x) = 1\]</span><p>for any \( x \). The resulting charge density after weighting looks like this:</p><p align=center><img alt=7.png src=/r/img/545/7.png></p><span>\[\rho_j = q_i \frac{x_{j+1} - x_i}{\Delta x} \qquad \rho_{j+1} = q_i \frac{x_i - x_j}{\Delta x}\]</span><p>The same weighting strategy extends to multiple dimensions. In 2D, this is bilinear weighting; in 3D we have trilinear. 1st order weighting requires more computational effort than nearest grid point, but produces smoother fields. The instantaneous appearance/disappearance of particles as they move across the grid is now gone, leading to a smoother electric field. This is the typical PIC weighting method. Higher-order weightings further reduce noise, but with dramatically increased computational expense. For example, a second-order scheme might be</p><p><span>\[S_2( x_j - x) = \frac{3}{4} - \left( \frac{x - x_j}{\Delta x} \right)^2\]
</span><span>\[S_2(x_{j \pm 1} - x) = \frac{1}{2} \left( \frac{1}{2} \pm \frac{x - x_j}{\Delta x} \right) ^2\]</span></p><p>All shape functions must satisfy conservation of charge \( \sum_j S(x_j - x) = 1 \) for any \( x \). But they must also preserve the first moment</p><span>\[\sum_j x_j S(x_j - x) = x\]</span><p>to preserve the electric dipole moment. And, of course, we require \( S(x) \geq 0 \) everywhere. This last requirement will trip up higher order methods if we naively use Lagrange interpolation functions. Instead, we can construct higher orders by using functions defined by convolutions of lower order shapes.</p><span>\[\begin{aligned}
m = 1 & \qquad & S _{NGP} \star S_{NGP} = \int S_0(x') S_0 (x - x') \dd x' = S_1(x) \\
m = 2 & \qquad & S_1 \star S_{NGP} = S_x(x)
\end{aligned}\]</span><p>As you go to higher and higher order, \( S_m(x) \) approaches a Gaussian.</p><p>Let us consider, does the particle shape affect the field distribution? What about the force distribution? Consider a uniform, finite-size ion and an infinitesimal electron (sheet), such that \( q_i + q_e = 0 \).</p><span>\[\int e n_i \dd x + \rho _s = 0\]</span><p>From Gauss&rsquo;s law,</p><span>\[\dv{E_x}{x} = \frac{\rho_c}{\epsilon_0}\]</span><p>with \( E_x = 0 \) outside. Solving Gauss&rsquo;s law, we find an electric field like this:</p><p align=center><img alt=8.png src=/r/img/545/8.png></p><p>From this, we conclude that outside of the particle extent, the field is independent of the particle shape. If we consider a charge sheet with an arbitrary shape \( \rho_c(x) \) in an electric field, bounded between \( x = a, x = b \), the force on the sheet is</p><span>\[F = \int_a ^b \rho_c (x) E_x \dd x = \int_a ^b \frac{\epsilon_0}{2} \dv{}{x} (E_x ^2) \dd x \\
= \frac{\epsilon_0}{2} (E_b ^2 - E_a ^2) = \epsilon_0 (E_b - E_a) \left( \frac{E_b + E_a}{2} \right) = \epsilon_0 \Delta E \overline{E} = q \overline{E}\]</span><p>The particle shape does not affect the physics outside of the particle shape. The force on the particle is only determined by the average electric field.</p><h2 id=particle-push>Particle Push
<a class=anchor href=#particle-push>#</a></h2><p>Once the source terms have been weighted to the grid, we wish to advance particles&rsquo; position and velocity based on the Lorentz force.</p><span>\[m \dv{\vec v}{t} = \vec F \\
\dv{\vec x}{t} = \vec v\]</span><p>We could solve these using any time integration technique, e.g. Runge-Kutta. But instead, we are going to choose a leap-frog method. It requires the fewest operations for the same order of accuracy (2nd order) and is a symplectic integrator, which means that it is a canonical transformation from one time to another time. Canonical transformations have important conservation properties; symplectic integrators conserve integrators, and are reversible in time.</p><p>To push the particles, we will use finite difference operators to approximate the ODEs.</p><span>\[m \frac{\vec v^{new} - \vec v^{old}}{\Delta t} = \langle \vec F \rangle \\
\frac{\vec x^{new} - \vec x^{old}}{\Delta t} = \langle \vec v \rangle\]</span><p>The averaging treatment we use to get the RHS determines the numerical accuracy and stability of the scheme.</p><span>\[\vec v^{new} = \vec v^{old} + \frac{\Delta t \langle F \rangle}{m} \\
\vec x^{new} = \vec x^{old} + \Delta t \langle \vec v \rangle\]</span><p>Here is where the leap-frog method comes in. We will center the right-hand side in time to get a 2nd order accuracy. By off-setting the velocity and position calculations, we get the average velocity we need for the centered leap-frog:</p><p align=center><img alt=9.png src=/r/img/545/9.png></p><p>To properly center the force, \( \vec E \) and \( \vec B \) must be expressed at the same points as position. They are then used to compute the next velocity \( v(n+1/2) \), from which we advance the position.</p><p>Leap-frog is second order accurate, but can be dispersive. This will give us incorrect wave speeds/frequencies/phase, but correct magnitude. Consider an electrostatic harmonic oscillator (Langmuir oscillations). For a charged particle oscillating around a fixed particle,</p><p><span>\[\frac{v^{n + 1/2} - v^{n-1/2}}{\Delta t} = \frac{q}{m} E(x^n)\]
</span><span>\[\frac{x^{n+1} - x^n}{\Delta t} = v^{n+1/2} \qquad \text{ and } \qquad \frac{x^n - x^{n-1}}{\Delta t} = v^{n-1/2}\]</span></p><p>Gauss&rsquo;s law gives</p><span>\[\dv{E}{x} = \frac{q n }{\epsilon_0} \rightarrow E(x^n) = \frac{q n }{\epsilon_0} x^n\]</span><p>Combine to give</p><span>\[\frac{x^{n+1} - 2 x^n + x ^{n-1}}{\Delta t^2} = \frac{q}{m} E(x^n) = - \frac{q^2 n}{m \epsilon_0} x^n = - \omega_p ^2 x^n\]</span><p>This equation approximates the ODE for Langmuir oscillations</p><span>\[\dv{^2 x}{t^2} + \omega_p ^2 x = 0\]</span><p>which has the solution</p><span>\[x(t) = C e^{\pm i \omega_p t}\]</span><p>That&rsquo;s the same finite difference we&rsquo;re using for our leap-frog particle push, which indicates that we&rsquo;re solving the same differential equation. We can assume an oscillating solution to our finite difference equation where</p><span>\[x^n = c e^{i \omega t^n}\]</span><p>where \( t^n = n \Delta t \). Substituting \( x^n \) into the finite difference expression,
<span>\[e^{i \omega \Delta t} - 2 + e^{- i \omega \Delta t} = - \omega _p ^2 \Delta t^2\]</span></p><p>Some algebraic manipulation leads to</p><span>\[2\left( \frac{e^{i \omega \Delta t} + e^{- i \omega \Delta t}}{2} - 1 \right) = - \omega_p ^2 \Delta t^2 \\
2 \left( \cos (\omega \Delta t) - 1 \right) = - \omega _p ^2 \Delta t^2\\
\sin ^2 \left( \frac{\omega \Delta t}{2} \right) = \left( \frac{\omega _p \Delta t}{2} \right)^2\]</span><p>That&rsquo;s interesting. We should have a solution \( \omega = \pm \omega_p \), but instead we have this other solution. Plotting \( (\omega \Delta t / 2) \) vs \( (\omega_p \Delta t / 2) \), we get a plot like this:</p><p align=center><img alt=10.png src=/r/img/545/10.png></p><p>The deviation from \( \omega = \omega_p \) is what&rsquo;s called a phase error. Nominally, we can set \( \Delta t \) to whatever we want. Setting \( \Delta t \) further out gives an imaginary \( \omega = \pm i \gamma \), so</p><span>\[x = c e^{\gamma t}\]</span><p>which is an unstable solution. So, if \( \Delta t \) is small, the leap frog finite difference gives an accurate solution. Increasing \( \Delta t \) enters a region where phase errors become large. Going all the way up to \( \Delta t = 2/\omega_p \), we get imaginary solutions to the differential equation and the solution becomes unstable. This is the <strong>Leap-frog instability.</strong></p><h2 id=electromagnetic-field-solver>Electromagnetic Field Solver
<a class=anchor href=#electromagnetic-field-solver>#</a></h2><p>At the field solver step, we need to advance \( \vec E \) and \( \vec B \) according to Maxwell&rsquo;s equations based on particles&rsquo; positions and velocities.</p><p>In the <strong>electrostatic</strong> case, Faraday&rsquo;s law reduces to
<span>\[\curl \vec E = 0 \rightarrow \vec E = - \grad \phi\]</span></p><p>Combined with Gauss&rsquo;s law, yields Poisson&rsquo;s equation</p><span>\[\div \vec E = \rho_c / \epsilon_0 \rightarrow \grad ^2 \phi = - \rho_c / \epsilon_0\]</span><p>Poisson&rsquo;s equation can be solved with finite differences. In 1D,</p><span>\[\frac{\phi _{j+1} - 2 \phi_j + \phi_{j-1}}{\Delta x^2} = - \frac{\rho_j}{\epsilon_0}\]</span><p>In matrix form, this yields a tridiagonal matrix equation.</p><span>\[\vec A \vec \phi = \vec b \rightarrow \vec \phi = \vec A ^{-1} \vec b\]</span><p>where</p><span>\[\vec \phi = \begin{bmatrix}
\phi_1 \\
\phi_2 \\
\vdots \\
\phi_J
\end{bmatrix}\]
</span><span>\[\vec A = \frac{1}{\Delta x^2} \begin{bmatrix} \ldots & 1 & -2 & 1 & \ldots \end{bmatrix}\]
</span><span>\[\vec b = \begin{bmatrix} - \rho_{j-1} / \epsilon_0 \\
- \rho_j / \epsilon_0 \\
\rho_{j+1} / \epsilon_0 \\
\ldots
\end{bmatrix}\]</span><p>We can run into some trouble here with periodic domains. For a periodic boundary condition, \( \vec A \) looks like</p><span>\[\vec A \sim \begin{bmatrix}
-2 & 1 & 0 & \\
1 & -2 & 1 & \\
\ldots & \ldots & \ldots & \ldots \\
\ldots & 1 & -2 & 1 \\
1 & \ldots & 1 & -2 \\
\end{bmatrix}\]</span><p>which is singular. This problem arises from a lack of appropriate boundary conditions. Even with periodic boundary conditions, we know the solution \( \phi \) is lacking an appropriate gauge, e.g. \( \phi_1 = 0 \) or \( \sum_j \phi_j = 0 \). Setting \( \phi_1 = 0 \) modifies \( \vec A \):</p><span>\[\vec A \sim \begin{bmatrix}
1 & 0 & 0 & \\
1 & -2 & 1 & \\
\ldots & \ldots & \ldots & \ldots \\
\ldots & 1 & -2 & 1 \\
1 & \ldots & 1 & -2 \\
\end{bmatrix}\]</span><p>This is no longer singular, and we can invert it.</p><p>With \( \phi_j \) in hand, we compute the electric field as</p><span>\[E_{x_{j}} = - \frac{\phi_{j+1} - \phi_{j-1}}{2 \Delta x}\]</span><p>and solve the Vlasov-Poisson system.</p><h3 id=periodic-domains---fourier-series-expansion>Periodic Domains - Fourier Series Expansion
<a class=anchor href=#periodic-domains---fourier-series-expansion>#</a></h3><p>For periodic domains, an alternative approach to solving Poisson&rsquo;s equation has some unique advantages compared to the finite difference method. In this approach, we transform from a discrete physical space to Fourier wave space. In wave space, differential operators become multiplications.</p><span>\[\rho(x) \overbrace{\rightarrow}^{FT} \rho(k)\]</span><p>using the transformation kernel \( e^{i k x} \). Poisson&rsquo;s equation becomes</p><span>\[k ^2 \phi (k) = \rho(k) / \epsilon_0 \rightarrow \phi(k) = \frac{\rho(k)}{\epsilon_0 k^2}\]</span><p>With the potential, an inverse fourier transform gives \( \phi(k) \rightarrow \phi(x) \). We can get the field either by computing the gradient</p><span>\[- \grad \phi(x) = \vec E(x)\]</span><p>or by computing the gradient first in phase space</p><span>\[i k \phi(k) = \vec E(k) \rightarrow \vec E(x)\]</span><p>We have a finite number of locations on our grid, so likewise our Fourier series expansion is also truncated at a finite \( k \).</p><span>\[g(k) = \Delta x \sum_{j=0} ^{J-1} g(x_j) e^{-i k x_j}\]</span><p>The continuous inverse transform is</p><span>\[g(x_j) = \frac{1}{2\pi} \int_{- \pi / \Delta x} ^{\pi / \Delta x} g(k) e^{i k x_j} \dd k \qquad \text{(infinite k)}\]</span><p>but for a discrete number of modes \( k \),</p><span>\[g(x_j) = \frac{1}{L} \sum_{n=-J/2} ^{J/2 - 1} g(k) e^{i k x_j}\]</span><p>where \( k = 2 \pi n / L \).</p><p>Finite Fourier transformations (FFT) are susceptible to <strong>aliasing</strong> errors. Higher wave numbers than we can resolve are aliased to lower frequencies.</p><span>\[E(k) = - i k \phi(k) \frac{\sin(k \Delta x)}{k \Delta x} = - i \kappa \phi(k)\]
</span><span>\[\phi(k) = \frac{\rho(k)}{\epsilon_0 k^2} \left[ \frac{k \Delta x}{\sin (k \Delta x)}\right]^2 = \frac{\rho(k)}{\epsilon_0 \kappa ^2}\]</span><p>The discrete effects vanish as \( k \Delta x \rightarrow 0 \) (infinite resolution). Aliasing occurs if \( |k \Delta x| > \pi \) which appears on the grid as lower values of \( k \Delta x \).</p><h2 id=full-electrostatic-pic-algorithm>Full Electrostatic PIC Algorithm
<a class=anchor href=#full-electrostatic-pic-algorithm>#</a></h2><p>Now we&rsquo;ve got everything we need to implement an electrostatic PIC model.</p><ul><li>Particle weighting to the grid using shape function (\( \vec j \) is not needed for electrostatics)
<span>\[ x_i \rightarrow \rho_j
\]</span></li><li>Electric field solve from Poisson&rsquo;s equation.<ul><li>Finite difference:
<span>\[ \grad ^2 \phi = - \rho / \epsilon_0 \rightarrow \vec E = - \grad \phi
\]</span></li><li>or FFT:
<span>\[ \rho(x_j) \overbrace{\rightarrow}^{FFT} \rho(k) \overbrace{\rightarrow}^{k^2} \phi(k) \overbrace{\rightarrow}^{k} \vec E(k) \overbrace{\rightarrow}^{IFFT} E(x_j)
\]</span></li></ul></li><li>Force weighting to particles using shape function
<span>\[ \vec E_j \rightarrow \vec F_i
\]</span></li><li>Leap frog advance to push the particles
<span>\[ \vec F_i \rightarrow \vec v_i \rightarrow \vec x_i
\]</span></li></ul><h2 id=magnetostatic-pic>Magnetostatic PIC
<a class=anchor href=#magnetostatic-pic>#</a></h2><p>In the magnetostatic case, we introduce a constant magnitude magnetic field into the mix. The Lorentz force becomes</p><span>\[\vec F_i = q \vec E + q ( \vec v_i \cross \vec B)\]</span><p>The effect of the magnetic field is to rotate the particle&rsquo;s trajectory. To compute the force on the particle, both \( \vec E \) and \( \vec B \) must be known at \( \vec x_i \). This changes how we represent our phase space. The minimum relevant configuration is 1D-2V, e.g. \( (x, v_x, v_y) \) with</p><p><span>\[\vec E = E_x \vu x\]
</span><span>\[\vec B = B_0 \vu z\]
</span><span>\[\vec v = v_x \vu x + v_y \vu y\]</span></p><p>\( \vec B \) does not alter the magnitude \( | \vec v | \). \( \vec E \) can alter the magnitude of \( | \vec v | \).</p><p>Both \( \vec E \) and \( \vec B \) must be centered in time relative to \( \vec v \). The Leap frog method advances \( \vec v ^{n - 1/2} \) to \( \vec v^{n + 1/2} \) using force and fields at time \( n \).</p><p>\( \vec v \) is known at \( n \pm \frac{1}{2} \), but we need to compute \( \vec B \) at \( n \). One solution is to use Strang splitting to split the advance (acceleration \( q \vec E \)) with the rotation \( q (\vec v \cross \vec B) = \omega_c (\vec v \cross \vec \vu z) \). The way this works is we apply half of the acceleration, then we apply the rotation, then the other half of the acceleration.</p><ul><li><p>Half acceleration
<span>\[v' _x = v_x ^{n - 1/2} + \frac{\Delta t}{2} \frac{q}{m} E_x ^n\]
</span><span>\[v' _y = v_y ^{n - 1/2}\]</span></p></li><li><p>Full Rotation
<span>\[\begin{bmatrix}
v_x '' \\
v_y ''
\end{bmatrix} =
\begin{bmatrix}
\cos (\omega_c \Delta t) & \sin ( \omega_c \Delta t) \\
- \sin ( \omega_c \Delta t) & \cos ( \omega_c \Delta t)
\end{bmatrix}
\begin{bmatrix}
v_x ' \\
v_y ' \end{bmatrix}\]</span></p></li><li><p>Half acceleration
<span>\[v_x ^{n + 1/2} = v_x '' + \frac{\Delta t}{2} \frac{q}{m} E_x ^n\]
</span><span>\[v_y ^{n + 1/2} = v_y ''\]</span></p></li></ul><p>This Strang splitting method is similar to e.g. Runge-Kutta methods which calculate an intermediate value, then use that value to step all the way.</p><p>Like all leap frog methods, we have to start magnetostatic PIC at \( n = 0 \). The initial conditions for magnetostatic PIC are the initial positions and velocities at \( t = 0 \), which give us the fields \( \vec E \) and \( \vec B \) at \( t = 0 \). We need \( \vec v ^{ n - 1/2} \), same as we did for the electrostatic case. We can start by applying a similar Strang splitting to integrate backwards in time by \( \Delta t / 2 \). We omit the first half-acceleration, and only perform an half rotation.</p><ul><li>Rotate</li></ul><span>\[\begin{bmatrix}
v_x ' \\ v_y '
\end{bmatrix} = \begin{bmatrix}
\cos ( - \omega _c \Delta t / 2) & \sin ( - \omega _c \Delta t / 2) \\
- \sin ( - \omega _c \Delta t / 2) & \cos ( - \omega_c \Delta t / 2)
\end{bmatrix} \begin{bmatrix}
v_x ^{n=0} \\
v_y ^{n=0} \end{bmatrix}\]</span><ul><li>Accelerate
<span>\[v_x ^{n = - 1/2} = v_x ' - \frac{\Delta t}{2} \frac{q}{m} E_x ^{n=0}\]
</span><span>\[v_y ^{n = - 1/2} = v_y '\]</span></li></ul><p>From there, we can proceed with the leap frog algorithm.</p><p align=center><img alt=11.png src=/r/img/545/11.png></p><h2 id=electrodynamic-pic>Electrodynamic PIC
<a class=anchor href=#electrodynamic-pic>#</a></h2><p>Finally, we allow the magnetic field to change in time. We still limit our model to 1D-2V (\( x, v_x, v_y \)), but now \( B_z \) is not constant and electric field \( E_y \) and current density \( j_y \) in the \( \vu y \) direction are allowed.</p><p align=center><img alt=12.png src=/r/img/545/12.png></p><p>Physically, this means that waves can propagate, but only in the \( \vu x \) direction. To compute the fields from grid sources, we need to solve the full Maxwell&rsquo;s equations. We&rsquo;ll do so in Heaviside-Lorentz units:</p><p><span>\[\pdv{\vec E}{t} = c \curl \vec B - \vec j\]
</span><span>\[\pdv{\vec B}{t} = - c \curl \vec E\]</span></p><p>In the 1D-2V system, these become</p><p><span>\[\pdv{E_y}{t} = - c \pdv{B_z}{x} - j_y\]
</span><span>\[\pdv{B_z}{t} = - c \pdv{E_y}{x}\]</span></p><p>Let&rsquo;s define some new variables:</p><p><span>\[F^+ \equiv \frac{E_y + B_z}{2}\]
</span><span>\[F^{-} \equiv \frac{E_y - B_z}{2}\]</span></p><p>These mean that</p><p><span>\[E_y = F^+ + F^-\]
</span><span>\[B_z = F^+ - F^-\]</span></p><p>So Maxwell&rsquo;s equations become (in matrix form)</p><span>\[\pdv{}{t} \begin{bmatrix} F^+ \\ F^- \end{bmatrix} + c \pdv{}{x} \begin{bmatrix} F^+ \\ - F^- \end{bmatrix} = - \frac{1}{2} \vec j_y \begin{bmatrix} 1 \\ 1 \end{bmatrix}\]</span><p>We notice the form of a conservation law. Notice on the left-hand side, we have the total derivative in Lagrangian frame moving at velocity \( \pm c \). We can define some other relevant terms. The Poynting flux is then</p><span>\[P = c \left[ \overbrace{(F^+)^2}^{\text{+ direction}} - \overbrace{(F^-)^2}^{\text{- direction}} \right]\]</span><p>The energy density is \( (F^+)^2 + (F^-)^2 \). We can update the fields in the Lagrangian frame of reference</p><span>\[\frac{F^+( t + \Delta t, x + c \Delta t) - F^+(t, x)}{\Delta t} = - \frac{1}{2} j_y (t + \frac{\Delta t}{2}, x + c \frac{\Delta t}{2})\]
</span><span>\[\frac{F^-( t + \Delta t, x - c \Delta t) - F^-(t, x)}{\Delta t} = - \frac{1}{2} j_y (t + \frac{\Delta t}{2}, x - c \frac{\Delta t}{2})\]</span><p>To properly center the current density relative to \( \vec E \), \( \vec B \) it must be centered at time step \( n + 1/2 \). Velocity is already centered properly to give \( j_y ^{n + 1/2} \). The location is given at \( x_i ^n \) and \( x_{i} ^{n+1} \), and are used to center \( j_y \) to the grid.</p><p>Considering the special case \( \Delta x = c \Delta t \), the method simplifies (though this is not a limitation of the method, just a simplified case):</p><p><span>\[{F_j^+}^{n+1} = {F_{j-1} ^+}^n - \frac{\Delta t}{4} \underbrace{\left({j_y}_j ^{n + 1/2} + {j_y}_{j - 1} ^{n + 1/2} \right)}_{2{j_y}_{j - 1/2}}\]
</span><span>\[{F_j^-}^{n+1} = {F_{j+1} ^-}^n - \frac{\Delta t}{4} \underbrace{\left({j_y}_j ^{n + 1/2} + {j_y}_{j + 1} ^{n + 1/2} \right)}_{2{j_y}_{j + 1/2}}\]</span></p><p align=center><img alt=13.png src=/r/img/545/13.png></p><h3 id=current-weighting>Current Weighting
<a class=anchor href=#current-weighting>#</a></h3><p>For arbitrary values of \( \Delta x \), we interpolate the value of \( j_y \) using the shape functions. Current weighting is always required for electrodynamic PIC. We still need charge weighting to compute \( E_x \).</p><p>Given the particle&rsquo;s position at \( x_i ^n \) and \( x_i ^{n+1} \), we use the shape function to distribute \( v_i ^{n + 1/2} \) across \( j_{j - 1/2} ^{n + 1/2} \) and \( j_{j + 1/2} ^{n + 1/2} \)</p><span>\[{j_y}_{j \pm 1/2} ^{n + 1/2} = \sum_i q_i v_i ^{n + 1/2} \left[ \frac{S(x_{j \pm 1} - x_i ^{n + 1}) + S(x_j - x_i ^n)}{2} \right]\]</span><h3 id=longitudinal-electric-field>Longitudinal Electric Field
<a class=anchor href=#longitudinal-electric-field>#</a></h3><p>In electrodynamic PIC, the longitudinal electric field \( E_x \) is computed as we did in the electrostatic case</p><span>\[\div \vec E = \div ( E_x \vu x + E_y \vu y) = \pdv{}{x} E_x = \rho / \epsilon_0\]</span><p>This implies that the wave vector \( \vec k \) is only in the \( \vu x \) direction.</p><h3 id=electrodynamic-pic-algorithm>Electrodynamic PIC algorithm
<a class=anchor href=#electrodynamic-pic-algorithm>#</a></h3><p>To advance electrodynamic PIC by a single time step.</p><p>At time \( n-1 \), we already know:</p><ul><li>\( x^{n-1} \)</li><li>\( v^{n-3/2} \)</li><li>\( E_x ^{n-1} \)</li><li>\( E_y ^{n-1} \)</li><li>\( B_z ^{n-1} \)</li></ul><p align=center><img alt=15.png src=/r/img/545/15.png></p><ol><li>At position \( x^{n-1} \), we compute the particle position
<span>\[x^{n-1} \rightarrow \rho_c ^{n-1}\]</span></li><li>We solve Poisson&rsquo;s equation using the source terms at \( n-1 \)
<span>\[\rho_c ^{n-1} \rightarrow E_x ^{n-1}\]</span></li><li>Weight the fields to the grid to get forces
<span>\[E_x ^{n-1}, E_y ^{n-1}, B_z ^{n-1} \rightarrow F_x ^{n-1}, F_y ^{n-1}\]</span></li><li>Advance the velocities using the weighted forces
<span>\[v^{n-3/2}, F_x ^{n-1}, F_y ^{n-1} \rightarrow v^{n-1/2}, j_y ^{n-1/2}\]</span></li><li>Advance the particle&rsquo;s position using the accelerated velocity
<span>\[v^{n-1/2} \rightarrow x^n\]</span></li><li>Solve Maxwell&rsquo;s equation to advance the transverse fields
<span>\[E_y ^{n-1}, B_z ^{n-1}, j_y ^{n-1/2} \rightarrow E_y ^n, B_z ^n\]</span></li></ol><h2 id=application-of-pic---two-stream-instability>Application of PIC - Two Stream Instability
<a class=anchor href=#application-of-pic---two-stream-instability>#</a></h2><p>An early use of the PIC method was investigation of beam-beam fusion. The idea is that you could quite easily achieve fusion by colliding two cold, counter-streaming beams. Two ion beams at 100keV can fuse to produce 17.6 MeV, at a gain of about 200. Easy peasy, right? It turns out the two-stream instability prevents us from achieving this exact scenario.</p><p>Initially, we can start with two cold beams. Uniform beams will exert no force on each other. But very quickly, we will see out of phase bunching. Any non-uniformity in the density will cause a perturbation in the velocity, along with a matching perturbation in the other beam. These perturbations travel in opposite directions, producing forces that mix the beams and thermalize the plasma. This converts kinetic into thermal energy, spreading the energy across a broad range of velocity. This means that the only ions that still have enough energy to fuse are those out at the tails of the distribution, so the gain goes to pot.</p><h3 id=dispersion-relation>Dispersion Relation
<a class=anchor href=#dispersion-relation>#</a></h3><p>The dispersion relation for a cold plasma is:</p><span>\[\frac{\omega_p ^2}{\omega ^2} = 1\]</span><p>If the plasma has a uniform velocity, such that the plasma becomes a cold beam, then the frequency is Doppler shifted</p><span>\[\frac{\omega_p ^2}{(\omega - k v_0) ^2} = 1\]</span><p>And if we have two cold beams, then</p><span>\[\frac{{\omega_p}_1 ^2}{(\omega - k v_1)^2} +\frac{{\omega_p}_2 ^2}{(\omega - k v_2)^2} = 1\]</span><p>For identical, counter-streaming beams, \( v_1 = - v_2 = v_0 \):</p><span>\[\frac{\omega_p ^2}{(\omega - k v_0)^2} + \frac{\omega_p ^2}{(\omega + k v_0)^2} = 1\]</span><p>We can solve for \( \omega \) and plot \( |\omega| / \omega_p \) vs \( k v_0 / \omega_p \):</p><p align=center><img alt=16.png src=/r/img/545/16.png></p><p>The unstable range where we have imaginary solutions for \( \omega \) is the <strong>two-stream instability</strong>. We got here from a linear analysis, so we assume \( v_1 \propto e^{-i \omega t} \). That&rsquo;s why the unstable solution goes like \( e^{\gamma t} \). The dispersion relation is a linear result. As the instability grows over time, nonlinear effects (like trapped particles) and saturation determine the long-term solution.</p><h2 id=boundary-conditions-for-finite-systems>Boundary Conditions for Finite Systems
<a class=anchor href=#boundary-conditions-for-finite-systems>#</a></h2><p>As with all PDEs, boundary conditions can critically affect the solution and require special numerical treatment. Let&rsquo;s consider some specific boundary conditions.</p><ul><li><strong>Conducting Wall</strong>. The wall will reflect EM fields:
<span>\[\vu n \cross \vec E = 0 \qquad \rightarrow \qquad \vec E_{\parallel} = 0\]</span></li></ul><p>Gauss&rsquo;s law tells us this leads to to the accumulation of a surface charge density</p><p><span>\[\vu n \cdot \vec E = \rho / \epsilon_0\]
</span><span>\[\rightarrow \vec E_n = \rho_s / \epsilon_0\]
</span>where \( \rho_s \) is a surface charge density.</p><p><span>\[\vu n \cdot \vec B = 0 \qquad \rightarrow \qquad \vec B_n = 0\]
</span><span>\[\vu n \cdot \pdv{\vec B}{t} = 0 \rightarrow \vec B_n = \text{const.}\]
</span><span>\[\vu n \cross \vec B = \mu_0 \vec j_s \rightarrow \vec B_t = \mu_0 \vec j_s \cross \vu n\]
</span>where \( \vec j_x \) is the surface current density.</p><ul><li><strong>Insulating Wall</strong>. The boundary conditions for an insulating wall will depend on the dielectric properties of the insulating wall. For a perfect insulator,</li></ul><p><span>\[\pdv{\vec E}{\vu n} = 0 \quad (\rho_s = 0)\]
</span>and
<span>\[\pdv{\vec B}{\vu n} = 0 \quad (\vec j_s \cdot \vu n = 0)\]</span></p><p>So that&rsquo;s the fields taken care of. What about the particles? At a boundary, they can be reflected, absorbed, or emitted, depending on the material properties and the properties of the impacting/emitted particles. What happens when a particle hits a material boundary depends on:</p><ul><li>The work function of the material</li><li>Secondary electron and ion emission coefficient</li><li>Applied or induced field/potential</li><li>Dielectric strength of material</li><li>Sputtering properties</li></ul><p>It is important to implement numerical boundary conditions that are consistent with the physics we&rsquo;re trying to model.</p><h3 id=implementation---reflected-particles>Implementation - Reflected Particles
<a class=anchor href=#implementation---reflected-particles>#</a></h3><p>For the reflection boundary condition, we want to generate a mirror image of the particle&rsquo;s trajectory. To view the scenario, let&rsquo;s look at a 1-dimensional particle traveling towards a reflecting boundary at \( x=0 \). We&rsquo;ll plot position along the horizontal axis and time along the vertical.</p><p align=center><img alt=17.png src=/r/img/545/17.png></p><p>We reflect the velocity when the particle crosses the boundary, such that \( {v^{n + 3/2}}&rsquo; \) now takes us to the reflected position \( {x^{n + 2}}&rsquo; \) instead of \( x ^{n+2} \). This eliminates the normal current, \( \vec j _n = 0 \)</p><h3 id=implementation---absorbedemitted-particles>Implementation - Absorbed/Emitted particles
<a class=anchor href=#implementation---absorbedemitted-particles>#</a></h3><p>For an absorption boundary, when charges and currents reach the boundary, they are deposited on the boundary and build up, unless it is an open boundary.</p><p>The inverse situation is emitting particles at the boundary. Charge and current from the boundary.</p><p>Let&rsquo;s consider a configuration in which we have electrodes at both side of our boundary, with a driving external current \( I(t) \) flowing between them.</p><p align=center><img alt=18.png src=/r/img/545/18.png></p><p>The total current \( I \) is the sum of hte convective plasma current and the displacement current. The total current density is</p><span>\[\vec j_{total} = (\rho \vec v)_{plasma} + \pdv{}{t} \vec E _{bias}\]</span><p>where \( \vec E_{bias} \) is the electric field that will develop across the domain.</p><p>To fit such a boundary within our leapfrog framework, all of the values must be properly centered for computing Maxwell&rsquo;s equations.</p><span>\[\vec j _{total} ^{n + 1/2} = \vec j _{plasma} ^{n + 1/2} + \frac{\vec E _{bias} ^{n+1} - \vec E _{bias} ^n}{\Delta t}\]</span><p>where</p><span>\[\vec j_{plasma} ^{n + 1/2} = \frac{1}{L} \sum _i q_i \vec v_i ^{n + 1/2}\]</span><p>and</p><span>\[\vec E_{bias} ^n = - \frac{\phi _b ^n - \phi _a ^n}{L} \vu x\]</span><p>The current density is then used to solve Ampere&rsquo;s law for the local electric field at the boundary \( \vec E_{local} \).</p><p>Particles are emitted from the electrode when the total electric field exceeds the threshold to pull particles from the surface (the work function). The process of pulling particles from the electrode when the field exceeds the work function is called <strong>field emission</strong>.</p><span>\[\vec E_{total} = \vec E_{bias} + \vec E_{local}\]</span><p>We typically emit particles at \( x_j = \pm \Delta x / 2 \) with a Maxwellian distribution at the wall temperature using Monte Carlo. We emit particles as long as the fied exceeds the work function.</p><p>Absorption leads to material interactions. Absorbed particles deposit their energy into the surface. This can lead to effects like:</p><ul><li>secondary electron and ion emission</li><li>sputtering</li><li>surface heating, which can lead to thermionic emission</li></ul><h3 id=implementation---open-boundaries>Implementation - Open Boundaries
<a class=anchor href=#implementation---open-boundaries>#</a></h3><p>In general, open boundaries can be difficult for PIC and Poisson solvers in general. This can be thought of as an impedance mismatch between the domain and the boundary. This scenario might occur when we&rsquo;re modeling plasmas in space, where we would like the boundary to be a perfect vacuum, and particles have no interaction with the boundary whatsoever. But with any impedance mismatch, we will get artificial reflections in the EM fields.</p><p>A common treatment for PIC codes is to append a dissipative layer to damp outgoing EM waves that enter the layer. Schematically, we draw this as a ramp-up of the impedance at the boundary over a width \( \delta \).</p><p align=center><img alt=19.png src=/r/img/545/19.png></p><p>A damping layer like this which dissipates all EM fields is called a <strong>Perfectly Matched Layer</strong> (PML). To get a PML, \( \delta \) must be greater than the longest wavelength of fields in the system \( \lambda_{longest} \), or allow non-physical configurations \( \div \vec B = 0 \).</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/Peppyhare/r/commit/6cfb8cfda5e08135fbe1455f69fe96a02e0ab37b title='Last modified by Evan Bluhm | April 28, 2021' target=_blank rel=noopener><img src=/r/svg/calendar.svg class=book-icon alt>
<span>April 28, 2021</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#particle-in-cell-model-particle-model-revisited>Particle-In-Cell Model (Particle model revisited)</a><ul><li><ul><li><a href=#relationship-to-n-body-and-kinetic-models>Relationship to N-Body and Kinetic Models</a></li></ul></li><li><a href=#general-comments-on-kinetic-models>General Comments on Kinetic Models</a></li><li><a href=#computational-methods-for-pic>Computational Methods for PIC</a></li><li><a href=#particle--force-weighting>Particle & Force Weighting</a></li><li><a href=#particle-push>Particle Push</a></li><li><a href=#electromagnetic-field-solver>Electromagnetic Field Solver</a><ul><li><a href=#periodic-domains---fourier-series-expansion>Periodic Domains - Fourier Series Expansion</a></li></ul></li><li><a href=#full-electrostatic-pic-algorithm>Full Electrostatic PIC Algorithm</a></li><li><a href=#magnetostatic-pic>Magnetostatic PIC</a></li><li><a href=#electrodynamic-pic>Electrodynamic PIC</a><ul><li><a href=#current-weighting>Current Weighting</a></li><li><a href=#longitudinal-electric-field>Longitudinal Electric Field</a></li><li><a href=#electrodynamic-pic-algorithm>Electrodynamic PIC algorithm</a></li></ul></li><li><a href=#application-of-pic---two-stream-instability>Application of PIC - Two Stream Instability</a><ul><li><a href=#dispersion-relation>Dispersion Relation</a></li></ul></li><li><a href=#boundary-conditions-for-finite-systems>Boundary Conditions for Finite Systems</a><ul><li><a href=#implementation---reflected-particles>Implementation - Reflected Particles</a></li><li><a href=#implementation---absorbedemitted-particles>Implementation - Absorbed/Emitted particles</a></li><li><a href=#implementation---open-boundaries>Implementation - Open Boundaries</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>